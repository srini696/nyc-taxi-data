AWSTemplateFormatVersion: "2010-09-09"
Metadata:
    Generator: "former2"
Description: ""
Resources:
    S3Bucket:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: "nyc-taxi-lake-0afffdf0f7eb"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: true
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket2:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: "nyc-taxi-warehouse"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "aws:kms"
                        KMSMasterKeyID: !GetAtt KMSKey.Arn
                    BucketKeyEnabled: true
            LoggingConfiguration: 
                DestinationBucketName: !Ref S3Bucket4
                LogFilePrefix: ""
            VersioningConfiguration: 
                Status: "Enabled"
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket3:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: "trip-data-quality-bkt"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: false
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket4:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: !Sub "${RedshiftServerlessNamespace}-access-logs-${AWS::AccountId}"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: true
            VersioningConfiguration: 
                Status: "Enabled"
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket5:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: "nyc-taxi-datasets-outputs-0afffdf0f7eb"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: false
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket6:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: !Sub "aws-cloudtrail-logs-${AWS::AccountId}-6e646e4e"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "aws:kms"
                        KMSMasterKeyID: !GetAtt KMSKey.Arn
                    BucketKeyEnabled: true
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket7:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: !Sub "aws-glue-assets-${AWS::AccountId}-${AWS::Region}"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: false
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket8:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: !Sub "${S3Bucket3}-results"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: false
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3Bucket9:
        Type: "AWS::S3::Bucket"
        Properties:
            BucketName: "nttdata-dev-transportation-nyc-taxi-raw"
            BucketEncryption: 
                ServerSideEncryptionConfiguration: 
                  - 
                    ServerSideEncryptionByDefault: 
                        SSEAlgorithm: "AES256"
                    BucketKeyEnabled: true
            VersioningConfiguration: 
                Status: "Enabled"
            OwnershipControls: 
                Rules: 
                  - 
                    ObjectOwnership: "BucketOwnerEnforced"
            PublicAccessBlockConfiguration: 
                BlockPublicAcls: true
                BlockPublicPolicy: true
                IgnorePublicAcls: true
                RestrictPublicBuckets: true

    S3BucketPolicy:
        Type: "AWS::S3::BucketPolicy"
        Properties:
            Bucket: !Ref S3Bucket2
            PolicyDocument: 
                Version: "2012-10-17"
                Statement: 
                  - 
                    Sid: "DenyUnencryptedUploads"
                    Effect: "Deny"
                    Principal: "*"
                    Action: "s3:PutObject"
                    Resource: !Sub "arn:aws:s3:::${S3Bucket2}/*"
                    Condition: 
                        StringNotEquals: 
                            "s3:x-amz-server-side-encryption": "aws:kms"
                  - 
                    Sid: "DenyInsecureConnections"
                    Effect: "Deny"
                    Principal: "*"
                    Action: "s3:*"
                    Resource: 
                      - !Sub "arn:aws:s3:::${S3Bucket2}"
                      - !Sub "arn:aws:s3:::${S3Bucket2}/*"
                    Condition: 
                        Bool: 
                            "aws:SecureTransport": "false"
                  - 
                    Sid: "AllowRedshiftAccess"
                    Effect: "Allow"
                    Principal: 
                        Service: "redshift.amazonaws.com"
                    Action: 
                      - "s3:GetObject"
                      - "s3:ListBucket"
                    Resource: 
                      - !Sub "arn:aws:s3:::${S3Bucket2}"
                      - !Sub "arn:aws:s3:::${S3Bucket2}/*"

    S3BucketPolicy2:
        Type: "AWS::S3::BucketPolicy"
        Properties:
            Bucket: !Ref S3Bucket4
            PolicyDocument: 
                Version: "2012-10-17"
                Id: "S3-Console-Auto-Gen-Policy-1768953775492"
                Statement: 
                  - 
                    Sid: "S3PolicyStmt-DO-NOT-MODIFY-1768953775296"
                    Effect: "Allow"
                    Principal: 
                        Service: "logging.s3.amazonaws.com"
                    Action: "s3:PutObject"
                    Resource: !Sub "arn:aws:s3:::${S3Bucket4}/*"
                    Condition: 
                        StringEquals: 
                            "aws:SourceAccount": !Ref AWS::AccountId

    S3BucketPolicy3:
        Type: "AWS::S3::BucketPolicy"
        Properties:
            Bucket: !Ref S3Bucket6
            PolicyDocument: 
                Version: "2012-10-17"
                Statement: 
                  - 
                    Sid: "AWSCloudTrailAclCheck20150319-55047c1b-6478-4410-80d7-680857006e5a"
                    Effect: "Allow"
                    Principal: 
                        Service: "cloudtrail.amazonaws.com"
                    Action: "s3:GetBucketAcl"
                    Resource: !Sub "arn:aws:s3:::${S3Bucket6}"
                    Condition: 
                        StringEquals: 
                            "AWS:SourceArn": !Sub "arn:aws:cloudtrail:${AWS::Region}:${AWS::AccountId}:trail/${RedshiftServerlessNamespace}-audit-trail"
                  - 
                    Sid: "AWSCloudTrailWrite20150319-450d32e1-174d-4b07-8b57-7b39eb7aad1e"
                    Effect: "Allow"
                    Principal: 
                        Service: "cloudtrail.amazonaws.com"
                    Action: "s3:PutObject"
                    Resource: !Sub "arn:aws:s3:::${S3Bucket6}/AWSLogs/${AWS::AccountId}/*"
                    Condition: 
                        StringEquals: 
                            "AWS:SourceArn": !Sub "arn:aws:cloudtrail:${AWS::Region}:${AWS::AccountId}:trail/${RedshiftServerlessNamespace}-audit-trail"
                            "s3:x-amz-acl": "bucket-owner-full-control"

    RDSDBInstance:
        Type: "AWS::RDS::DBInstance"
        Properties:
            DBInstanceIdentifier: "nyc-taxi-mdm-db"
            AllocatedStorage: 45
            DBInstanceClass: "db.t4g.micro"
            Engine: "mysql"
            MasterUsername: "mdm_admin"
            MasterUserPassword: "REPLACEME"
            PreferredBackupWindow: "04:18-04:48"
            BackupRetentionPeriod: 1
            AvailabilityZone: !Sub "${AWS::Region}d"
            PreferredMaintenanceWindow: "sun:05:36-sun:06:06"
            MultiAZ: false
            EngineVersion: "8.0.43"
            AutoMinorVersionUpgrade: true
            LicenseModel: "general-public-license"
            PubliclyAccessible: true
            StorageType: "gp2"
            Port: 3306
            StorageEncrypted: true
            KmsKeyId: !Sub "arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/d7f5f872-a28d-46be-8d95-a34a46f855d2"
            CopyTagsToSnapshot: true
            MonitoringInterval: 60
            EnableIAMDatabaseAuthentication: false
            EnablePerformanceInsights: false
            DeletionProtection: false
            DBSubnetGroupName: "default-vpc-0f555e0765b5e806e"
            VPCSecurityGroups: 
              - "sg-0fbdd85b08ec89173"
              - "sg-02d6212a2f5eb4e9d"
            MaxAllocatedStorage: 1000
            DBParameterGroupName: "default.mysql8.0"
            OptionGroupName: "default:mysql-8-0"
            MonitoringRoleArn: !GetAtt IAMRole10.Arn
            CACertificateIdentifier: "rds-ca-rsa2048-g1"

    RDSDBSubnetGroup:
        Type: "AWS::RDS::DBSubnetGroup"
        Properties:
            DBSubnetGroupDescription: "Created from the RDS Management Console"
            DBSubnetGroupName: "default-vpc-0f555e0765b5e806e"
            SubnetIds: 
              - "subnet-035019ddcaf604cc1"
              - "subnet-015a32a4e12b26561"
              - "subnet-0cc3bdd4bded8cab8"
              - "subnet-0826e31fd816e808d"
              - "subnet-06559bb761049eb5a"
              - "subnet-0d5b87d5ae0829b87"

    IAMUser:
        Type: "AWS::IAM::User"
        Properties:
            Path: "/"
            UserName: "mdm-engineer-user"
            Groups: 
              - !Ref IAMGroup

    IAMUser2:
        Type: "AWS::IAM::User"
        Properties:
            Path: "/"
            UserName: "mdm-owner-user"
            Groups: 
              - !Ref IAMGroup3

    IAMUser3:
        Type: "AWS::IAM::User"
        Properties:
            Path: "/"
            UserName: "mdm-steward-user"
            Groups: 
              - !Ref IAMGroup2

    IAMGroup:
        Type: "AWS::IAM::Group"
        Properties:
            Path: "/"
            GroupName: "mdm-engineers"
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRDSDataFullAccess"

    IAMGroup2:
        Type: "AWS::IAM::Group"
        Properties:
            Path: "/"
            GroupName: "mdm-stewards"
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRDSDataFullAccess"

    IAMGroup3:
        Type: "AWS::IAM::Group"
        Properties:
            Path: "/"
            GroupName: "mdm-owners"
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRDSDataFullAccess"

    IAMRole:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "AWSGlueServiceRole-NycTaxi"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"glue.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/service-role/AWSGlueServiceRole"
              - "arn:aws:iam::aws:policy/AmazonS3FullAccess"
            Description: "Allows Glue to call AWS services on your behalf. "

    IAMRole2:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: "AmazonRedshift-CommandsAccessRole-20260119T230150"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":[\"sagemaker.amazonaws.com\",\"redshift.amazonaws.com\",\"redshift-serverless.amazonaws.com\"]},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRedshiftAllCommandsFullAccess"
              - !Ref IAMManagedPolicy31

    IAMRole3:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: "mdm-aggregate-review-items-role-c04tc6kk"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy27

    IAMRole4:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "lambda_rds_sqs"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRDSDataFullAccess"
              - "arn:aws:iam::aws:policy/AmazonSQSFullAccess"
              - "arn:aws:iam::aws:policy/AWSStepFunctionsFullAccess"
              - !Ref IAMManagedPolicy9
            Description: "Allows Lambda functions to call AWS services on your behalf."

    IAMRole5:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "glue-crawler-role"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"glue.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRDSFullAccess"
              - "arn:aws:iam::aws:policy/SecretsManagerReadWrite"
              - "arn:aws:iam::aws:policy/service-role/AWSGlueServiceRole"
              - "arn:aws:iam::aws:policy/AmazonS3FullAccess"
              - "arn:aws:iam::aws:policy/service-role/ROSAKMSProviderPolicy"
            Description: "Allows Glue to call AWS services on your behalf. "

    IAMRole6:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "AWSService_glue_rds_Role"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"glue.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonVPCCrossAccountNetworkInterfaceOperations"
              - "arn:aws:iam::aws:policy/AmazonRDSFullAccess"
              - "arn:aws:iam::aws:policy/SecretsManagerReadWrite"
              - "arn:aws:iam::aws:policy/service-role/AWSGlueServiceRole"
              - "arn:aws:iam::aws:policy/AWSGlueConsoleFullAccess"
              - "arn:aws:iam::aws:policy/AmazonVPCFullAccess"
              - "arn:aws:iam::aws:policy/AWSKeyManagementServicePowerUser"
              - "arn:aws:iam::aws:policy/AmazonS3FullAccess"
              - "arn:aws:iam::aws:policy/AmazonOpenSearchDirectQueryGlueCreateAccess"
              - "arn:aws:iam::aws:policy/AWSGlueSchemaRegistryFullAccess"
            Description: "Allows Glue to call AWS services on your behalf. "

    IAMRole7:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: "mdm-fetch-curated-trips-role-0ge0aawg"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy15

    IAMRole8:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: "mdm-validate-input-role-xn3uz0mp"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy6

    IAMRole9:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: !Ref IAMPolicy3
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"redshift.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRedshiftFullAccess"
              - "arn:aws:iam::aws:policy/CloudWatchLogsFullAccess"
              - "arn:aws:iam::aws:policy/service-role/AWSGlueServiceRole"
              - "arn:aws:iam::aws:policy/AmazonS3FullAccess"
            Description: "Allows Redshift clusters to call AWS services on your behalf."

    IAMRole10:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "rds-monitoring-role"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"monitoring.rds.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole"

    IAMRole11:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: !Ref IAMPolicy
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"redshift.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            Description: "Allows Redshift clusters to call AWS services on your behalf."

    IAMRole12:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: !Ref IAMPolicy2
            AssumeRolePolicyDocument: !Sub "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::${AWS::AccountId}:root\"},\"Action\":\"sts:AssumeRole\",\"Condition\":{}}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonRedshiftReadOnlyAccess"
              - "arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess"
            Description: ""

    IAMRole13:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: !Sub "${RedshiftServerlessNamespace}_cloudtrail"
            AssumeRolePolicyDocument: !Sub "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Action\":\"sts:AssumeRole\",\"Condition\":{\"StringEquals\":{\"aws:SourceAccount\":\"${AWS::AccountId}\",\"aws:SourceArn\":\"arn:aws:cloudtrail:${AWS::Region}:${AWS::AccountId}:trail/${RedshiftServerlessNamespace}-audit-trail\"}}}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy28
              - !Ref IAMManagedPolicy29
            Description: !Sub "Role for config CloudWathLogs for trail ${RedshiftServerlessNamespace}-audit-trail"

    IAMRole14:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: !Sub "${RedshiftServerlessNamespace}-redshift-role"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"redshift.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess"
              - !Ref IAMManagedPolicy18
            Description: "Allows Redshift clusters to call AWS services on your behalf."

    IAMRole15:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: !Sub "StepFunctions-${StepFunctionsStateMachine2.Name}-role-ggacx4q5j"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy25
              - !Ref IAMManagedPolicy11
              - !Ref IAMManagedPolicy
              - !Ref IAMManagedPolicy20

    IAMRole16:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "SecretsManagerRedshiftRot-SecretsManagerRedshiftRot-aELNO8zGCKGB"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
              - "arn:aws:iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
            Description: ""
            Tags: 
              - 
                Key: "lambda:createdBy"
                Value: "SAM"
              - 
                Key: "SecretsManagerLambda"
                Value: "Rotation"

    IAMRole17:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/"
            RoleName: "s3-lambda"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - "arn:aws:iam::aws:policy/AmazonS3FullAccess"
            Description: "Allows Lambda functions to call AWS services on your behalf."

    IAMRole18:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: !Sub "StepFunctions-nyc-taxi-${StepFunctionsStateMachine2.Name}-role-s3klzlpce"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy19
              - !Ref IAMManagedPolicy32
              - !Ref IAMManagedPolicy10

    IAMRole19:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: !Sub "StepFunctions-${StepFunctionsStateMachine4.Name}-role-ibi510h0v"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy12
              - !Ref IAMManagedPolicy21
              - !Ref IAMManagedPolicy26
              - !Ref IAMManagedPolicy23

    IAMRole20:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: !Sub "StepFunctions-${StepFunctionsStateMachine.Name}-role-nhc3y8lld"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"states.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy14
              - !Ref IAMManagedPolicy7

    IAMRole21:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: "VendorAutoApproveFunction-role-belpn0gl"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy3
              - !Ref IAMManagedPolicy24

    IAMRole22:
        Type: "AWS::IAM::Role"
        Properties:
            Path: "/service-role/"
            RoleName: "VendorSendToQueueFunction-role-agpnhgez"
            AssumeRolePolicyDocument: "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"lambda.amazonaws.com\"},\"Action\":\"sts:AssumeRole\"}]}"
            MaxSessionDuration: 3600
            ManagedPolicyArns: 
              - !Ref IAMManagedPolicy5
              - !Ref IAMManagedPolicy4

    IAMServiceLinkedRole:
        Type: "AWS::IAM::ServiceLinkedRole"
        Properties:
            AWSServiceName: "cost-optimization-hub.bcm.amazonaws.com"
            Description: "Allows Cost Optimization Hub to retrieve organization information and collect optimization-related data and metadata."

    IAMServiceLinkedRole2:
        Type: "AWS::IAM::ServiceLinkedRole"
        Properties:
            AWSServiceName: "rds.amazonaws.com"
            Description: "Allows Amazon RDS to manage AWS resources on your behalf"

    IAMServiceLinkedRole3:
        Type: "AWS::IAM::ServiceLinkedRole"
        Properties:
            AWSServiceName: "redshift.amazonaws.com"
            Description: "Allows Amazon Redshift to call AWS services on your behalf"

    IAMServiceLinkedRole4:
        Type: "AWS::IAM::ServiceLinkedRole"
        Properties:
            AWSServiceName: "ec2-nat-gateway.amazonaws.com"
            Description: "Provides permissions to manage VPC resources for the configuration and management of NAT Gateways."

    IAMServiceLinkedRole5:
        Type: "AWS::IAM::ServiceLinkedRole"
        Properties:
            AWSServiceName: "resource-explorer-2.amazonaws.com"

    IAMManagedPolicy:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "GlueJobRunManagementFullAccessPolicy-161fa4b8-69b0-4b1e-bb59-a7f1a1255bc3"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Statement": [
                        {
                            "Action": [
                                "glue:StartJobRun",
                                "glue:GetJobRun",
                                "glue:GetJobRuns",
                                "glue:BatchStopJobRun"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                "*"
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                }

    IAMManagedPolicy2:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSGlueServiceRole-taxi-zone-EZCRC-s3Policy"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "s3:GetObject",
                                "s3:PutObject"
                            ],
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket9}/nyc-taxi-raw/reference/taxi_zone_lookup.csv/*"
                            ],
                            "Condition": {
                                "StringEquals": {
                                    "aws:ResourceAccount": "${AWS::AccountId}"
                                }
                            }
                        }
                    ]
                }

    IAMManagedPolicy3:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaBasicExecutionRole-692b7bf4-5af3-4d6c-82b8-26902009d20c"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": "logs:CreateLogGroup",
                            "Resource": "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:*"
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream",
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/VendorAutoApproveFunction:*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy4:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaBasicExecutionRole-b0d89034-3b9d-40db-b07d-5a41df9162bd"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": "logs:CreateLogGroup",
                            "Resource": "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:*"
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream",
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/VendorSendToQueueFunction:*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy5:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaVPCAccessExecutionRole-10d6da30-7030-43ef-9158-3ede3bda1291"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "ec2:CreateNetworkInterface",
                                "ec2:DeleteNetworkInterface",
                                "ec2:DescribeNetworkInterfaces"
                            ],
                            "Resource": "*"
                        }
                    ]
                }

    IAMManagedPolicy6:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaBasicExecutionRole-4f5aaee5-f6a9-4cba-8409-731db6fb1ec8"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": "logs:CreateLogGroup",
                            "Resource": "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:*"
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream",
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/mdm-validate-input:*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy7:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "XRayAccessPolicy-2963636b-8d03-41d4-a9fe-fad7faded832"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Resource": [
                                "*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy8:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "DataAnalysts-S3-Taxi-ReadOnly"
            Path: "/"
            PolicyDocument: |
                {
                  "Version": "2012-10-17",
                  "Statement": [
                    {
                      "Effect": "Allow",
                      "Action": [
                        "s3:GetObject",
                        "s3:ListBucket"
                      ],
                      "Resource": [
                        "arn:aws:s3:::nttdata-dev-transportation-nyc-taxi-*",
                        "arn:aws:s3:::nttdata-dev-transportation-nyc-taxi-*/*"
                      ]
                    }
                  ]
                }
                

    IAMManagedPolicy9:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaVPCAccessExecutionRole-ea8131ed-004a-41a5-ab87-0a157caf518d"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "ec2:CreateNetworkInterface",
                                "ec2:DeleteNetworkInterface",
                                "ec2:DescribeNetworkInterfaces"
                            ],
                            "Resource": "*"
                        }
                    ]
                }

    IAMManagedPolicy10:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "SnsPublishScopedAccessPolicy-705103b0-03e9-43a5-b7d1-8e4f5c056417"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "sns:Publish"
                            ],
                            "Resource": [
                                "${SNSTopic3}"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy11:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "XRayAccessPolicy-0b16a9cb-2921-40bc-aef2-2b6f49940998"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Resource": [
                                "*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy12:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "LambdaInvokeScopedAccessPolicy-0741d670-1acf-48df-8429-304ade10bed8"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-process-pipeline:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-approval:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-enrich-trip:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-update-audit-history:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-proposal-status:*"
                            ]
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-process-pipeline",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-approval",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-enrich-trip",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-update-audit-history",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-proposal-status"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy13:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSGlueServiceRole-yellow-taxitrip-EZCRC-s3Policy"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "s3:GetObject",
                                "s3:PutObject"
                            ],
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket9}/nyc-taxi-raw/trips/yellow_tripdata_2025-08.parquet/*"
                            ],
                            "Condition": {
                                "StringEquals": {
                                    "aws:ResourceAccount": "${AWS::AccountId}"
                                }
                            }
                        }
                    ]
                }

    IAMManagedPolicy14:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "LambdaInvokeScopedAccessPolicy-a5953a2e-ab36-47ef-912f-8f6ca7e049ba"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorSendToQueueFunction:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorProposeFunction:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorAutoApproveFunction:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorStewardDecisionFunction:*"
                            ]
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorSendToQueueFunction",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorProposeFunction",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorAutoApproveFunction",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorStewardDecisionFunction"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy15:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaBasicExecutionRole-c8362095-e1c0-4cc4-baed-83e55cd52583"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": "logs:CreateLogGroup",
                            "Resource": "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:*"
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream",
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/mdm-fetch-curated-trips:*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy16:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "DataEngineers-S3-Taxi-FullAccess"
            Path: "/"
            PolicyDocument: |
                {
                  "Version": "2012-10-17",
                  "Statement": [
                    {
                      "Effect": "Allow",
                      "Action": [
                        "s3:*"
                      ],
                      "Resource": [
                        "arn:aws:s3:::nttdata-dev-transportation-nyc-taxi-*",
                        "arn:aws:s3:::nttdata-dev-transportation-nyc-taxi-*/*"
                      ]
                    }
                  ]
                }
                

    IAMManagedPolicy17:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSGlueServiceRole-basic-EZCRC-s3Policy"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "s3:GetObject",
                                "s3:PutObject"
                            ],
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket9}/nyc-taxi-raw/reference/taxi_zone_lookup.csv/*"
                            ],
                            "Condition": {
                                "StringEquals": {
                                    "aws:ResourceAccount": "${AWS::AccountId}"
                                }
                            }
                        }
                    ]
                }

    IAMManagedPolicy18:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: !Sub "${RedshiftServerlessNamespace}-secrets-access"
            Path: "/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "AllowSecretsAccess",
                            "Effect": "Allow",
                            "Action": [
                                "secretsmanager:GetSecretValue",
                                "secretsmanager:DescribeSecret"
                            ],
                            "Resource": [
                                "arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:${RedshiftServerlessNamespace}/*"
                            ]
                        },
                        {
                            "Sid": "AllowKMSDecrypt",
                            "Effect": "Allow",
                            "Action": [
                                "kms:Decrypt"
                            ],
                            "Resource": [
                                "arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/${KMSKey}"
                            ]
                        }
                    ]
                }
                

    IAMManagedPolicy19:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "LambdaInvokeScopedAccessPolicy-c6ea86e4-4a21-43d2-b930-b474fed8a71b"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-extract-references:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-approval:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-enrich-trip:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-propose-golden-v2:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-proposal-status:*"
                            ]
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-extract-references",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-approval",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-enrich-trip",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-propose-golden-v2",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-proposal-status"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy20:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "SnsPublishScopedAccessPolicy-49d74e7f-7598-4f89-aadd-62d28a6f4d90"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "sns:Publish"
                            ],
                            "Resource": [
                                "${SNSTopic3}"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy21:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "XRayAccessPolicy-fa520150-becb-4b74-a48b-fedf97ae2239"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Resource": [
                                "*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy22:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSGlueServiceRole-sample-role-EZCRC-s3Policy"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "s3:GetObject",
                                "s3:PutObject"
                            ],
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket9}/nyc-taxi-raw/reference/*"
                            ],
                            "Condition": {
                                "StringEquals": {
                                    "aws:ResourceAccount": "${AWS::AccountId}"
                                }
                            }
                        }
                    ]
                }

    IAMManagedPolicy23:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "SnsPublishScopedAccessPolicy-41d15a93-e1d4-496d-9e45-7644f5e38f1b"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "sns:Publish"
                            ],
                            "Resource": [
                                "${SNSTopic3}"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy24:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaVPCAccessExecutionRole-6df72d76-e74b-48c5-af86-481cfdf9c094"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "ec2:CreateNetworkInterface",
                                "ec2:DeleteNetworkInterface",
                                "ec2:DescribeNetworkInterfaces"
                            ],
                            "Resource": "*"
                        }
                    ]
                }

    IAMManagedPolicy25:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "LambdaInvokeScopedAccessPolicy-81b6b9d4-44ab-4fbc-89ff-a60bc2348e42"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-extract-references:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-log-rejected-records:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-aggregate-review-items:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-check-approval:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-batch-enrich-trips:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-update-audit-history:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-log-pipeline-execution:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-fetch-curated-trips:*",
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-create-golden-table:*"
                            ]
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "lambda:InvokeFunction"
                            ],
                            "Resource": [
                                "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:mdm-extract-references",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-log-rejected-records",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-aggregate-review-items",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-check-approval",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-batch-enrich-trips",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-update-audit-history",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-log-pipeline-execution",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-fetch-curated-trips",
                                "arn:aws:lambda:us-east-1:473157801752:function:mdm-create-golden-table"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy26:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "GlueJobRunManagementFullAccessPolicy-59f9c8a6-eae1-4a01-bc1d-5eee338ff6f0"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Statement": [
                        {
                            "Action": [
                                "glue:StartJobRun",
                                "glue:GetJobRun",
                                "glue:GetJobRuns",
                                "glue:BatchStopJobRun"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                "*"
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                }

    IAMManagedPolicy27:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSLambdaBasicExecutionRole-28ee8251-6017-41ad-a753-79dc972b858d"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": "logs:CreateLogGroup",
                            "Resource": "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:*"
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream",
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/lambda/mdm-aggregate-review-items:*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy28:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: !Sub "Cloudtrail-CW-access-policy-${RedshiftServerlessNamespace}-audit-trail-57d1c699-44fd-49e4-90ec-320346464607"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "AWSCloudTrailCreateLogStream2014110",
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/cloudtrail/${RedshiftServerlessNamespace}:log-stream:${AWS::AccountId}_CloudTrail_${AWS::Region}*"
                            ]
                        },
                        {
                            "Sid": "AWSCloudTrailPutLogEvents20141101",
                            "Effect": "Allow",
                            "Action": [
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:/aws/cloudtrail/${RedshiftServerlessNamespace}:log-stream:${AWS::AccountId}_CloudTrail_${AWS::Region}*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy29:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: !Sub "Cloudtrail-CW-access-policy-${RedshiftServerlessNamespace}-audit-trail-ee804874-d400-4be4-92a9-feea1dbb3f4d"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "AWSCloudTrailCreateLogStream2014110",
                            "Effect": "Allow",
                            "Action": [
                                "logs:CreateLogStream"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9:log-stream:${AWS::AccountId}_CloudTrail_${AWS::Region}*"
                            ]
                        },
                        {
                            "Sid": "AWSCloudTrailPutLogEvents20141101",
                            "Effect": "Allow",
                            "Action": [
                                "logs:PutLogEvents"
                            ],
                            "Resource": [
                                "arn:aws:logs:${AWS::Region}:${AWS::AccountId}:log-group:aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9:log-stream:${AWS::AccountId}_CloudTrail_${AWS::Region}*"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy30:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AWSGlueServiceRole-taxi-nyc-crawl-EZCRC-s3Policy"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "s3:GetObject",
                                "s3:PutObject"
                            ],
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket9}/nyc-taxi-raw/reference/taxi_zone_lookup.csv/*"
                            ],
                            "Condition": {
                                "StringEquals": {
                                    "aws:ResourceAccount": "${AWS::AccountId}"
                                }
                            }
                        }
                    ]
                }

    IAMManagedPolicy31:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "AmazonRedshift-CommandsAccessPolicy-20260119T230150"
            Path: "/service-role/"
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Action": [
                                "s3:GetObject",
                                "s3:GetBucketAcl",
                                "s3:GetBucketCors",
                                "s3:GetEncryptionConfiguration",
                                "s3:GetBucketLocation",
                                "s3:ListBucket",
                                "s3:ListAllMyBuckets",
                                "s3:ListMultipartUploadParts",
                                "s3:ListBucketMultipartUploads",
                                "s3:PutObject",
                                "s3:PutBucketAcl",
                                "s3:PutBucketCors",
                                "s3:DeleteObject",
                                "s3:AbortMultipartUpload",
                                "s3:CreateBucket"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket2}/*",
                                "arn:aws:s3:::${S3Bucket2}"
                            ]
                        }
                    ]
                }

    IAMManagedPolicy32:
        Type: "AWS::IAM::ManagedPolicy"
        Properties:
            ManagedPolicyName: "XRayAccessPolicy-373a9ec8-a38e-4828-9662-e2b6116e751c"
            Path: "/service-role/"
            PolicyDocument: |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Resource": [
                                "*"
                            ]
                        }
                    ]
                }

    IAMPolicy:
        Type: "AWS::IAM::Policy"
        Properties:
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Sid": "RedshiftReadAndApprove",
                            "Effect": "Allow",
                            "Action": [
                                "redshift:DescribeClusters",
                                "redshift:GetClusterCredentials"
                            ],
                            "Resource": "*"
                        },
                        {
                            "Sid": "SecretsAccess",
                            "Effect": "Allow",
                            "Action": [
                                "secretsmanager:GetSecretValue"
                            ],
                            "Resource": "arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:${RedshiftServerlessNamespace}/steward-credentials*"
                        }
                    ]
                }
            Roles: 
              - !Ref IAMRole11
            PolicyName: !Ref IAMRole11

    IAMPolicy2:
        Type: "AWS::IAM::Policy"
        Properties:
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "redshift:DescribeClusters",
                                "redshift:GetClusterCredentials"
                            ],
                            "Resource": [
                                "arn:aws:redshift:${AWS::Region}:${AWS::AccountId}:cluster:${RedshiftServerlessNamespace}",
                                "arn:aws:redshift:${AWS::Region}:${AWS::AccountId}:dbname:${RedshiftServerlessNamespace}/dev",
                                "arn:aws:redshift:${AWS::Region}:${AWS::AccountId}:dbuser:${RedshiftServerlessNamespace}/analyst_user"
                            ]
                        }
                    ]
                }
            Roles: 
              - !Ref IAMRole12
            PolicyName: !Ref IAMRole12

    IAMPolicy3:
        Type: "AWS::IAM::Policy"
        Properties:
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": "redshift:*",
                            "Resource": "arn:aws:redshift:${AWS::Region}:${AWS::AccountId}:cluster:${RedshiftServerlessNamespace}"
                        },
                        {
                            "Effect": "Allow",
                            "Action": "s3:*",
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket2}",
                                "arn:aws:s3:::${S3Bucket2}/*"
                            ]
                        }
                    ]
                }
            Roles: 
              - !Ref IAMRole9
            PolicyName: !Ref IAMRole9

    IAMPolicy4:
        Type: "AWS::IAM::Policy"
        Properties:
            PolicyDocument: "{\"Statement\":[{\"Action\":[\"ec2:CreateNetworkInterface\",\"ec2:DeleteNetworkInterface\",\"ec2:DescribeNetworkInterfaces\",\"ec2:DetachNetworkInterface\"],\"Resource\":\"*\",\"Effect\":\"Allow\"}]}"
            Roles: 
              - !Ref IAMRole16
            PolicyName: "SecretsManagerRedshiftRotationSingleUserRolePolicy0"

    IAMPolicy5:
        Type: "AWS::IAM::Policy"
        Properties:
            PolicyDocument: !Sub |
                {
                    "Version": "2012-10-17",
                    "Statement": [
                        {
                            "Effect": "Allow",
                            "Action": [
                                "s3:GetObject",
                                "s3:ListBucket"
                            ],
                            "Resource": [
                                "arn:aws:s3:::${S3Bucket2}",
                                "arn:aws:s3:::${S3Bucket2}/*"
                            ]
                        },
                        {
                            "Effect": "Allow",
                            "Action": [
                                "kms:Decrypt",
                                "kms:GenerateDataKey"
                            ],
                            "Resource": "arn:aws:kms:${AWS::Region}:${AWS::AccountId}:key/${KMSKey}"
                        }
                    ]
                }
                
            Roles: 
              - !Ref IAMRole14
            PolicyName: "redshift-s3-kms-access"

    IAMPolicy6:
        Type: "AWS::IAM::Policy"
        Properties:
            PolicyDocument: !Sub "{\"Statement\":[{\"Condition\":{\"StringEquals\":{\"secretsmanager:resource/AllowRotationLambdaArn\":\"arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:SecretsManagerrotation_lambda\"}},\"Action\":[\"secretsmanager:DescribeSecret\",\"secretsmanager:GetSecretValue\",\"secretsmanager:PutSecretValue\",\"secretsmanager:UpdateSecretVersionStage\"],\"Resource\":\"arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:*\",\"Effect\":\"Allow\"},{\"Action\":[\"secretsmanager:GetRandomPassword\"],\"Resource\":\"*\",\"Effect\":\"Allow\"}]}"
            Roles: 
              - !Ref IAMRole16
            PolicyName: "SecretsManagerRedshiftRotationSingleUserRolePolicy1"

    KMSKey:
        Type: "AWS::KMS::Key"
        Properties:
            Enabled: true
            Description: "Encryption key for NYC Taxi Data Warehouse"
            KeyUsage: "ENCRYPT_DECRYPT"
            KeyPolicy: !Sub |
                {
                  "Version" : "2012-10-17",
                  "Id" : "key-consolepolicy-3",
                  "Statement" : [ {
                    "Sid" : "Enable IAM User Permissions",
                    "Effect" : "Allow",
                    "Principal" : {
                      "AWS" : "arn:aws:iam::${AWS::AccountId}:root"
                    },
                    "Action" : "kms:*",
                    "Resource" : "*"
                  }, {
                    "Sid" : "Allow access for Key Administrators",
                    "Effect" : "Allow",
                    "Principal" : {
                      "AWS" : [ "arn:aws:iam::${AWS::AccountId}:role/aws-service-role/redshift.amazonaws.com/AWSServiceRoleForRedshift", "arn:aws:iam::${AWS::AccountId}:user/mdm-owner-user" ]
                    },
                    "Action" : [ "kms:Create*", "kms:Describe*", "kms:Enable*", "kms:List*", "kms:Put*", "kms:Update*", "kms:Revoke*", "kms:Disable*", "kms:Get*", "kms:Delete*", "kms:TagResource", "kms:UntagResource", "kms:ScheduleKeyDeletion", "kms:CancelKeyDeletion", "kms:RotateKeyOnDemand" ],
                    "Resource" : "*"
                  }, {
                    "Sid" : "Allow use of the key",
                    "Effect" : "Allow",
                    "Principal" : {
                      "AWS" : [ "arn:aws:iam::${AWS::AccountId}:role/${IAMRole4}", "arn:aws:iam::${AWS::AccountId}:role/aws-service-role/redshift.amazonaws.com/AWSServiceRoleForRedshift", "arn:aws:iam::${AWS::AccountId}:role/${IAMRole6}" ]
                    },
                    "Action" : [ "kms:Encrypt", "kms:Decrypt", "kms:ReEncrypt*", "kms:GenerateDataKey*", "kms:DescribeKey" ],
                    "Resource" : "*"
                  }, {
                    "Sid" : "Allow attachment of persistent resources",
                    "Effect" : "Allow",
                    "Principal" : {
                      "AWS" : [ "arn:aws:iam::${AWS::AccountId}:role/${IAMRole4}", "arn:aws:iam::${AWS::AccountId}:role/aws-service-role/redshift.amazonaws.com/AWSServiceRoleForRedshift", "arn:aws:iam::${AWS::AccountId}:role/${IAMRole6}" ]
                    },
                    "Action" : [ "kms:CreateGrant", "kms:ListGrants", "kms:RevokeGrant" ],
                    "Resource" : "*",
                    "Condition" : {
                      "Bool" : {
                        "kms:GrantIsForAWSResource" : "true"
                      }
                    }
                  }, {
                    "Sid" : "Allow Redshift to use the key",
                    "Effect" : "Allow",
                    "Principal" : {
                      "Service" : "redshift.amazonaws.com"
                    },
                    "Action" : [ "kms:Encrypt", "kms:Decrypt", "kms:GenerateDataKey*", "kms:DescribeKey" ],
                    "Resource" : "*",
                    "Condition" : {
                      "StringEquals" : {
                        "aws:SourceAccount" : "arn:aws:iam::${AWS::AccountId}"
                      }
                    }
                  } ]
                }
            KeySpec: "SYMMETRIC_DEFAULT"
            MultiRegion: false

    KMSAlias:
        Type: "AWS::KMS::Alias"
        Properties:
            AliasName: !Sub "alias/${RedshiftServerlessNamespace}-key"
            TargetKeyId: !Ref KMSKey

    StepFunctionsStateMachine:
        Type: "AWS::StepFunctions::StateMachine"
        Properties:
            StateMachineName: "VendorApprovalFlow"
            DefinitionString: !Sub |
                {
                  "Comment": "Vendor approval with confidence-based routing",
                  "StartAt": "ProposeVendor",
                  "States": {
                    "ProposeVendor": {
                      "Type": "Task",
                      "Resource": "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorProposeFunction",
                      "Parameters": {
                        "vendor_name.$": "$.vendor_name",
                        "source_system.$": "$.source_system"
                      },
                      "ResultPath": "$.proposal",
                      "Next": "CheckConfidence"
                    },
                    "CheckConfidence": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.proposal.match_confidence",
                          "NumericGreaterThanEquals": 95,
                          "Next": "AutoApprove"
                        },
                        {
                          "Variable": "$.proposal.match_confidence",
                          "NumericGreaterThanEquals": 80,
                          "Next": "StewardReview"
                        }
                      ],
                      "Default": "ManualResolution"
                    },
                    "AutoApprove": {
                      "Type": "Task",
                      "Resource": "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorAutoApproveFunction",
                      "Parameters": {
                        "vendor_id.$": "$.proposal.vendor_id",
                        "change_id.$": "$.proposal.change_id"
                      },
                      "End": true
                    },
                    "StewardReview": {
                      "Type": "Task",
                      "Resource": "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorSendToQueueFunction",
                      "Parameters": {
                        "vendor_id.$": "$.proposal.vendor_id",
                        "execution_arn.$": "$$.Execution.Id"
                      },
                      "Next": "WaitForSteward"
                    },
                    "WaitForSteward": {
                      "Type": "Task",
                      "Resource": "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorStewardDecisionFunction",
                      "Parameters": {
                        "vendor_id.$": "$.proposal.vendor_id",
                        "execution_arn.$": "$$.Execution.Id"
                      },
                      "HeartbeatSeconds": 3600,
                      "TimeoutSeconds": 86400,
                      "End": true
                    },
                    "ManualResolution": {
                      "Type": "Task",
                      "Resource": "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:VendorSendToQueueFunction",
                      "Parameters": {
                        "vendor_id.$": "$.proposal.vendor_id",
                        "execution_arn.$": "$$.Execution.Id"
                      },
                      "End": true
                    }
                  }
                }
            RoleArn: !GetAtt IAMRole20.Arn
            StateMachineType: "STANDARD"
            LoggingConfiguration: 
                IncludeExecutionData: false
                Level: "OFF"

    StepFunctionsStateMachine2:
        Type: "AWS::StepFunctions::StateMachine"
        Properties:
            StateMachineName: "mdm-pipeline"
            DefinitionString: !Sub |
                {
                  "Comment": "NYC Taxi MDM Pipeline - Integrated with Glue ETL Jobs",
                  "StartAt": "InitializePipeline",
                  "States": {
                    "InitializePipeline": {
                      "Type": "Pass",
                      "Comment": "Initialize pipeline with timestamp and execution ID",
                      "Parameters": {
                        "pipelineRunId.$": "States.Format('mdm-run-{}-{}', $$.Execution.StartTime, $$.Execution.Name)",
                        "triggeredBy": "glue-workflow",
                        "executionStartTime.$": "$$.Execution.StartTime",
                        "sourceSystem": "nyc_taxi_curated",
                        "processedCount": 0
                      },
                      "ResultPath": "$",
                      "Next": "RunRawToValidatedGlue"
                    },
                    "RunRawToValidatedGlue": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::glue:startJobRun.sync",
                      "Parameters": {
                        "JobName": "yellow_raw_to_validated"
                      },
                      "ResultPath": "$.rawToValidatedResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 30,
                          "MaxAttempts": 2,
                          "BackoffRate": 2
                        }
                      ],
                      "Catch": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "ResultPath": "$.glueError",
                          "Next": "LogGlueFailure"
                        }
                      ],
                      "Next": "RunValidatedToCuratedGlue"
                    },
                    "RunValidatedToCuratedGlue": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::glue:startJobRun.sync",
                      "Parameters": {
                        "JobName": "yellow_validated_to_curated"
                      },
                      "ResultPath": "$.validatedToCuratedResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 30,
                          "MaxAttempts": 2,
                          "BackoffRate": 2
                        }
                      ],
                      "Catch": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "ResultPath": "$.glueError",
                          "Next": "LogGlueFailure"
                        }
                      ],
                      "Next": "FetchCuratedData"
                    },
                    "FetchCuratedData": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-fetch-curated-trips",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "batchSize": 1000,
                          "processingMode": "incremental"
                        }
                      },
                      "ResultSelector": {
                        "pipelineRunId.$": "$.Payload.pipelineRunId",
                        "tripIds.$": "$.Payload.tripIds",
                        "recordCount.$": "$.Payload.recordCount",
                        "hasMore.$": "$.Payload.hasMore"
                      },
                      "ResultPath": "$.curatedDataBatch",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 300,
                          "MaxAttempts": 3,
                          "BackoffRate": 2
                        }
                      ],
                      "Next": "CheckDataAvailable"
                    },
                    "CheckDataAvailable": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.curatedDataBatch.recordCount",
                          "NumericGreaterThan": 0,
                          "Next": "ProcessTripBatch"
                        }
                      ],
                      "Default": "NoDataToProcess"
                    },
                    "ProcessTripBatch": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-extract-references",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "tripIds.$": "$.curatedDataBatch.tripIds",
                          "sourceSystem.$": "$.sourceSystem"
                        }
                      },
                      "ResultSelector": {
                        "tripsProcessed.$": "$.Payload.tripsProcessed",
                        "tripsNeedingReview.$": "$.Payload.tripsNeedingReview",
                        "totalProcessed.$": "$.Payload.totalProcessed"
                      },
                      "ResultPath": "$.batchResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 10,
                          "MaxAttempts": 3,
                          "BackoffRate": 2
                        }
                      ],
                      "Next": "UpdateProcessedCount"
                    },
                    "UpdateProcessedCount": {
                      "Type": "Pass",
                      "Parameters": {
                        "pipelineRunId.$": "$.pipelineRunId",
                        "sourceSystem.$": "$.sourceSystem",
                        "processedCount.$": "States.MathAdd($.processedCount, $.batchResult.totalProcessed)",
                        "rawToValidatedResult.$": "$.rawToValidatedResult",
                        "validatedToCuratedResult.$": "$.validatedToCuratedResult",
                        "executionStartTime.$": "$.executionStartTime",
                        "hasMore.$": "$.curatedDataBatch.hasMore"
                      },
                      "Next": "CheckForMoreData"
                    },
                    "CheckForMoreData": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.hasMore",
                          "BooleanEquals": true,
                          "Next": "FetchCuratedData"
                        }
                      ],
                      "Default": "CheckForStewardReviews"
                    },
                    "CheckForStewardReviews": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-aggregate-review-items",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultSelector": {
                        "pendingCount.$": "$.Payload.pendingCount",
                        "summary.$": "$.Payload.summary"
                      },
                      "ResultPath": "$.reviewSummary",
                      "Next": "HasPendingReviews"
                    },
                    "HasPendingReviews": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.reviewSummary.pendingCount",
                          "NumericGreaterThan": 0,
                          "Next": "PrepareSNSMessage"
                        }
                      ],
                      "Default": "CreateGoldenRecordTable"
                    },
                    "PrepareSNSMessage": {
                      "Type": "Pass",
                      "Parameters": {
                        "pipelineRunId.$": "$.pipelineRunId",
                        "summary.$": "$.reviewSummary.summary",
                        "message": "MDM records require steward review and approval",
                        "totalPending.$": "$.reviewSummary.pendingCount"
                      },
                      "ResultPath": "$.snsMessagePayload",
                      "Next": "NotifyStewardReview"
                    },
                    "NotifyStewardReview": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::sns:publish",
                      "Parameters": {
                        "TopicArn": "${SNSTopic3}",
                        "Message.$": "States.JsonToString($.snsMessagePayload)",
                        "Subject": "MDM Review Required - Pending Approval"
                      },
                      "ResultPath": "$.snsResult",
                      "Next": "WaitForStewardApproval"
                    },
                    "WaitForStewardApproval": {
                      "Type": "Wait",
                      "Seconds": 300,
                      "Next": "CheckApprovalStatus"
                    },
                    "CheckApprovalStatus": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-check-approval",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultSelector": {
                        "allApproved.$": "$.Payload.allApproved",
                        "anyRejected.$": "$.Payload.anyRejected",
                        "stillPending.$": "$.Payload.stillPending"
                      },
                      "ResultPath": "$.approvalStatus",
                      "Next": "ApprovalDecision"
                    },
                    "ApprovalDecision": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.approvalStatus.allApproved",
                          "BooleanEquals": true,
                          "Next": "EnrichPendingTrips"
                        },
                        {
                          "Variable": "$.approvalStatus.anyRejected",
                          "BooleanEquals": true,
                          "Next": "HandleRejectedRecords"
                        },
                        {
                          "Variable": "$.approvalStatus.stillPending",
                          "BooleanEquals": true,
                          "Next": "WaitForStewardApproval"
                        }
                      ],
                      "Default": "HandleRejectedRecords"
                    },
                    "EnrichPendingTrips": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-batch-enrich-trips",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultPath": "$.enrichedPendingTrips",
                      "Next": "CreateGoldenRecordTable"
                    },
                    "HandleRejectedRecords": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-log-rejected-records",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultPath": "$.rejectionLog",
                      "Next": "CreateGoldenRecordTable"
                    },
                    "CreateGoldenRecordTable": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-create-golden-table",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultSelector": {
                        "recordsCreated.$": "$.Payload.recordsCreated"
                      },
                      "ResultPath": "$.goldenTableResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 10,
                          "MaxAttempts": 3,
                          "BackoffRate": 2
                        }
                      ],
                      "Next": "UpdateAuditTables"
                    },
                    "UpdateAuditTables": {
                      "Type": "Parallel",
                      "Branches": [
                        {
                          "StartAt": "UpdateVendorHistory",
                          "States": {
                            "UpdateVendorHistory": {
                              "Type": "Task",
                              "Resource": "arn:aws:states:::lambda:invoke",
                              "Parameters": {
                                "FunctionName": "mdm-update-audit-history",
                                "Payload": {
                                  "entityType": "vendor",
                                  "pipelineRunId.$": "$$.Execution.Name"
                                }
                              },
                              "End": true
                            }
                          }
                        },
                        {
                          "StartAt": "UpdateZoneHistory",
                          "States": {
                            "UpdateZoneHistory": {
                              "Type": "Task",
                              "Resource": "arn:aws:states:::lambda:invoke",
                              "Parameters": {
                                "FunctionName": "mdm-update-audit-history",
                                "Payload": {
                                  "entityType": "zone",
                                  "pipelineRunId.$": "$$.Execution.Name"
                                }
                              },
                              "End": true
                            }
                          }
                        },
                        {
                          "StartAt": "UpdateRatecodeHistory",
                          "States": {
                            "UpdateRatecodeHistory": {
                              "Type": "Task",
                              "Resource": "arn:aws:states:::lambda:invoke",
                              "Parameters": {
                                "FunctionName": "mdm-update-audit-history",
                                "Payload": {
                                  "entityType": "ratecode",
                                  "pipelineRunId.$": "$$.Execution.Name"
                                }
                              },
                              "End": true
                            }
                          }
                        }
                      ],
                      "ResultPath": "$.auditUpdateResults",
                      "Next": "LogPipelineExecution"
                    },
                    "LogPipelineExecution": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-log-pipeline-execution",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "executionStatus": "SUCCESS",
                          "glueJobs": {
                            "rawToValidated.$": "$.rawToValidatedResult",
                            "validatedToCurated.$": "$.validatedToCuratedResult"
                          },
                          "recordsProcessed.$": "$.processedCount",
                          "goldenRecordsCreated.$": "$.goldenTableResult.recordsCreated",
                          "pendingReviews.$": "$.reviewSummary.pendingCount",
                          "executionTime": {
                            "start.$": "$.executionStartTime",
                            "end.$": "$$.State.EnteredTime"
                          }
                        }
                      },
                      "ResultPath": "$.executionLog",
                      "Next": "PipelineSuccess"
                    },
                    "NoDataToProcess": {
                      "Type": "Pass",
                      "Result": {
                        "status": "NO_DATA",
                        "message": "No new curated data available for processing"
                      },
                      "Next": "LogPipelineExecution"
                    },
                    "LogGlueFailure": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-log-pipeline-execution",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "executionStatus": "GLUE_FAILURE",
                          "error.$": "$.glueError"
                        }
                      },
                      "Next": "PipelineFailed"
                    },
                    "PipelineSuccess": {
                      "Type": "Succeed"
                    },
                    "PipelineFailed": {
                      "Type": "Fail",
                      "Error": "PipelineExecutionError",
                      "Cause": "Pipeline execution failed"
                    }
                  }
                }
            RoleArn: !GetAtt IAMRole15.Arn
            StateMachineType: "STANDARD"
            LoggingConfiguration: 
                IncludeExecutionData: false
                Level: "OFF"

    StepFunctionsStateMachine3:
        Type: "AWS::StepFunctions::StateMachine"
        Properties:
            StateMachineName: !Sub "nyc-taxi-${StepFunctionsStateMachine2.Name}"
            DefinitionString: !Sub |
                {
                  "Comment": "NYC Taxi MDM - NO QUALITY GATE (Testing Only)",
                  "StartAt": "ExtractTripReferences",
                  "States": {
                    "ExtractTripReferences": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-extract-references",
                        "Payload": {
                          "tripData.$": "$.tripData",
                          "sourceSystem.$": "$.sourceSystem"
                        }
                      },
                      "ResultPath": "$.tripReferences",
                      "Next": "CheckIfMissingEntities"
                    },
                    "CheckIfMissingEntities": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.tripReferences.Payload.totalMissing",
                          "NumericGreaterThan": 0,
                          "Next": "ProposeMissingMasters"
                        }
                      ],
                      "Default": "EnrichGoldenTrip"
                    },
                    "ProposeMissingMasters": {
                      "Type": "Map",
                      "ItemsPath": "$.tripReferences.Payload.missingEntities",
                      "MaxConcurrency": 3,
                      "ResultPath": "$.proposedGoldenRecords",
                      "Iterator": {
                        "StartAt": "FuzzyMatchGoldenRecord",
                        "States": {
                          "FuzzyMatchGoldenRecord": {
                            "Type": "Task",
                            "Resource": "arn:aws:states:::lambda:invoke",
                            "Parameters": {
                              "FunctionName": "mdm-propose-golden-v2",
                              "Payload": {
                                "entityType.$": "$.entityType",
                                "sourceId.$": "$.sourceId",
                                "proposedName.$": "$.proposedName",
                                "sourceSystem.$": "$.sourceSystem",
                                "tripData.$": "$.tripData"
                              }
                            },
                            "ResultPath": "$.goldenRecordResult",
                            "End": true
                          }
                        }
                      },
                      "Next": "CheckProposalResults"
                    },
                    "CheckProposalResults": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-check-proposal-status",
                        "Payload": {
                          "proposedRecords.$": "$.proposedGoldenRecords"
                        }
                      },
                      "ResultPath": "$.proposalStatus",
                      "Next": "StewardReviewGate"
                    },
                    "StewardReviewGate": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.proposalStatus.Payload.needsStewardReview",
                          "BooleanEquals": true,
                          "Next": "PrepareSNSMessage"
                        }
                      ],
                      "Default": "EnrichGoldenTrip"
                    },
                    "PrepareSNSMessage": {
                      "Type": "Pass",
                      "Parameters": {
                        "pipelineRunId.$": "$.pipelineRunId",
                        "tripId.$": "$.tripData.tripId",
                        "pendingRecords.$": "$.proposalStatus.Payload.pendingRecords",
                        "summary.$": "$.proposalStatus.Payload.summary",
                        "message": "MDM records require steward review and approval"
                      },
                      "ResultPath": "$.snsMessagePayload",
                      "Next": "NotifyStewardReview"
                    },
                    "NotifyStewardReview": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::sns:publish",
                      "Parameters": {
                        "TopicArn": "${SNSTopic3}",
                        "Message.$": "States.JsonToString($.snsMessagePayload)",
                        "Subject": "MDM Review Required - Pending Approval"
                      },
                      "ResultPath": "$.snsResult",
                      "Next": "WaitForStewardApproval"
                    },
                    "WaitForStewardApproval": {
                      "Type": "Wait",
                      "Seconds": 300,
                      "Next": "CheckApprovalStatus"
                    },
                    "CheckApprovalStatus": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-check-approval",
                        "Payload": {
                          "pendingRecords.$": "$.proposalStatus.Payload.pendingRecords"
                        }
                      },
                      "ResultPath": "$.approvalStatus",
                      "Next": "ApprovalDecision"
                    },
                    "ApprovalDecision": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.approvalStatus.Payload.allApproved",
                          "BooleanEquals": true,
                          "Next": "EnrichGoldenTrip"
                        },
                        {
                          "Variable": "$.approvalStatus.Payload.anyRejected",
                          "BooleanEquals": true,
                          "Next": "HandleRejection"
                        },
                        {
                          "Variable": "$.approvalStatus.Payload.stillPending",
                          "BooleanEquals": true,
                          "Next": "WaitForStewardApproval"
                        }
                      ],
                      "Default": "HandleRejection"
                    },
                    "EnrichGoldenTrip": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Parameters": {
                        "FunctionName": "mdm-enrich-trip",
                        "Payload": {
                          "tripData.$": "$.tripData",
                          "proposedRecords.$": "$.proposedGoldenRecords",
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultPath": "$.goldenTrip",
                      "Next": "AuditSuccess"
                    },
                    "AuditSuccess": {
                      "Type": "Pass",
                      "Result": {
                        "status": "SUCCESS"
                      },
                      "End": true
                    },
                    "HandleRejection": {
                      "Type": "Pass",
                      "Result": {
                        "status": "REJECTED"
                      },
                      "End": true
                    }
                  }
                }
            RoleArn: !GetAtt IAMRole18.Arn
            StateMachineType: "STANDARD"
            LoggingConfiguration: 
                IncludeExecutionData: false
                Level: "OFF"

    StepFunctionsStateMachine4:
        Type: "AWS::StepFunctions::StateMachine"
        Properties:
            StateMachineName: "taxi-nyc-pipeline"
            DefinitionString: !Sub |
                {
                  "Comment": "Optimized MDM Pipeline - Batch Processing with Steward Approval",
                  "StartAt": "InitializePipeline",
                  "States": {
                    "InitializePipeline": {
                      "Type": "Pass",
                      "Comment": "Initialize pipeline parameters",
                      "Parameters": {
                        "pipelineRunId.$": "States.Format('mdm-run-{}', $$.Execution.Name)",
                        "triggeredBy": "step-functions",
                        "executionStartTime.$": "$$.Execution.StartTime",
                        "executionArn.$": "$$.Execution.Id",
                        "batchSize": 100000,
                        "autoApproveThreshold": 0.85,
                        "totalProcessed": 0,
                        "totalAutoApproved": 0,
                        "totalNeedingReview": 0
                      },
                      "Next": "CreateAuditRecord"
                    },
                    "CreateAuditRecord": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Create initial audit record",
                      "Parameters": {
                        "FunctionName": "mdm-update-audit-history",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "triggeredBy.$": "$.triggeredBy",
                          "executionArn.$": "$.executionArn",
                          "eventType": "start"
                        }
                      },
                      "ResultPath": "$.auditResult",
                      "Next": "RunRawToValidatedGlue"
                    },
                    "RunRawToValidatedGlue": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::glue:startJobRun.sync",
                      "Parameters": {
                        "JobName": "yellow_raw_to_validated"
                      },
                      "ResultPath": "$.rawToValidatedResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 30,
                          "MaxAttempts": 2,
                          "BackoffRate": 2
                        }
                      ],
                      "Catch": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "ResultPath": "$.error",
                          "Next": "PipelineFailed"
                        }
                      ],
                      "Next": "RunValidatedToCuratedGlue"
                    },
                    "RunValidatedToCuratedGlue": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::glue:startJobRun.sync",
                      "Parameters": {
                        "JobName": "yellow_validated_to_curated"
                      },
                      "ResultPath": "$.validatedToCuratedResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "IntervalSeconds": 30,
                          "MaxAttempts": 2,
                          "BackoffRate": 2
                        }
                      ],
                      "Catch": [
                        {
                          "ErrorEquals": [
                            "States.ALL"
                          ],
                          "ResultPath": "$.error",
                          "Next": "PipelineFailed"
                        }
                      ],
                      "Next": "ProcessBatch"
                    },
                    "ProcessBatch": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Process batch: fetch trips, match entities, create PROPOSED records",
                      "Parameters": {
                        "FunctionName": "mdm-process-pipeline",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "batchSize.$": "$.batchSize",
                          "autoApproveThreshold.$": "$.autoApproveThreshold"
                        }
                      },
                      "ResultSelector": {
                        "status.$": "$.Payload.status",
                        "stats.$": "$.Payload.stats",
                        "summary.$": "$.Payload.summary"
                      },
                      "ResultPath": "$.batchResult",
                      "Retry": [
                        {
                          "ErrorEquals": [
                            "States.TaskFailed"
                          ],
                          "IntervalSeconds": 10,
                          "MaxAttempts": 2,
                          "BackoffRate": 2
                        }
                      ],
                      "Next": "CheckBatchStatus"
                    },
                    "CheckBatchStatus": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.batchResult.status",
                          "StringEquals": "NO_DATA",
                          "Next": "CheckForPendingApprovals"
                        },
                        {
                          "Variable": "$.batchResult.status",
                          "StringEquals": "FAILED",
                          "Next": "PipelineFailed"
                        }
                      ],
                      "Default": "UpdateBatchCounters"
                    },
                    "UpdateBatchCounters": {
                      "Type": "Pass",
                      "Comment": "Accumulate statistics across batches",
                      "Parameters": {
                        "pipelineRunId.$": "$.pipelineRunId",
                        "triggeredBy.$": "$.triggeredBy",
                        "executionStartTime.$": "$.executionStartTime",
                        "batchSize.$": "$.batchSize",
                        "autoApproveThreshold.$": "$.autoApproveThreshold",
                        "totalProcessed.$": "States.MathAdd($.totalProcessed, $.batchResult.stats.tripsProcessed)",
                        "totalAutoApproved.$": "States.MathAdd($.totalAutoApproved, $.batchResult.stats.autoApproved)",
                        "totalNeedingReview.$": "States.MathAdd($.totalNeedingReview, $.batchResult.stats.needsStewardReview)",
                        "rawToValidatedResult.$": "$.rawToValidatedResult",
                        "validatedToCuratedResult.$": "$.validatedToCuratedResult",
                        "lastBatchProcessed.$": "$.batchResult.stats.tripsProcessed"
                      },
                      "Next": "ShouldProcessMoreBatches"
                    },
                    "ShouldProcessMoreBatches": {
                      "Type": "Choice",
                      "Comment": "Continue processing if last batch had data",
                      "Choices": [
                        {
                          "Variable": "$.lastBatchProcessed",
                          "NumericGreaterThan": 0,
                          "Next": "ProcessBatch"
                        }
                      ],
                      "Default": "UpdateAuditAfterBatches"
                    },
                    "UpdateAuditAfterBatches": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Update audit with batch processing statistics",
                      "Parameters": {
                        "FunctionName": "mdm-update-audit-history",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "eventType": "batch_update",
                          "totalProcessed.$": "$.totalProcessed",
                          "totalAutoApproved.$": "$.totalAutoApproved",
                          "totalNeedingReview.$": "$.totalNeedingReview"
                        }
                      },
                      "ResultPath": "$.auditResult",
                      "Next": "CheckForPendingApprovals"
                    },
                    "CheckForPendingApprovals": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Check if there are PROPOSED records needing steward approval",
                      "Parameters": {
                        "FunctionName": "mdm-check-proposal-status",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultSelector": {
                        "hasProposed.$": "$.Payload.hasProposed",
                        "counts.$": "$.Payload.counts",
                        "totalProposed.$": "$.Payload.totalProposed"
                      },
                      "ResultPath": "$.proposedCheck",
                      "Next": "HasProposedRecords"
                    },
                    "HasProposedRecords": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.proposedCheck.hasProposed",
                          "BooleanEquals": true,
                          "Next": "SendStewardNotification"
                        }
                      ],
                      "Default": "PipelineSuccess"
                    },
                    "SendStewardNotification": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::sns:publish",
                      "Parameters": {
                        "TopicArn": "${SNSTopic3}",
                        "Subject": "MDM Review Required - Action Needed",
                        "Message.$": "States.Format('Pipeline Run: {}\n\n=== STATISTICS ===\nTotal Trips Processed: {}\nAuto-Approved Matches: {}\nNeed Steward Review: {}\n\n=== PROPOSED RECORDS ===\nVendors: {}\nZones: {}\nRate Codes: {}\n\nPlease review and approve records in the MDM system.\n\nThe pipeline will check for approvals every 5 minutes.\n\nExecution: {}', $.pipelineRunId, $.totalProcessed, $.totalAutoApproved, $.totalNeedingReview, $.proposedCheck.counts.vendors, $.proposedCheck.counts.zones, $.proposedCheck.counts.ratecodes, $$.Execution.Name)"
                      },
                      "ResultPath": null,
                      "Next": "WaitForStewardApproval"
                    },
                    "WaitForStewardApproval": {
                      "Type": "Wait",
                      "Comment": "Wait 5 minutes before checking for approvals",
                      "Seconds": 300,
                      "Next": "CheckApprovalStatus"
                    },
                    "CheckApprovalStatus": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Check if steward has approved any PROPOSED records",
                      "Parameters": {
                        "FunctionName": "mdm-check-approval",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId"
                        }
                      },
                      "ResultSelector": {
                        "hasNewApprovals.$": "$.Payload.hasNewApprovals",
                        "allProposedProcessed.$": "$.Payload.allProposedProcessed",
                        "approvedRecords.$": "$.Payload.approvedRecords",
                        "stats.$": "$.Payload.stats"
                      },
                      "ResultPath": "$.approvalStatus",
                      "Next": "EvaluateApprovalStatus"
                    },
                    "EvaluateApprovalStatus": {
                      "Type": "Choice",
                      "Choices": [
                        {
                          "Variable": "$.approvalStatus.hasNewApprovals",
                          "BooleanEquals": true,
                          "Next": "EnrichApprovedTrips"
                        },
                        {
                          "Variable": "$.approvalStatus.allProposedProcessed",
                          "BooleanEquals": true,
                          "Next": "PipelineSuccess"
                        }
                      ],
                      "Default": "WaitForStewardApproval"
                    },
                    "EnrichApprovedTrips": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Enrich trips that were waiting for the newly approved master data",
                      "Parameters": {
                        "FunctionName": "mdm-enrich-trip",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "approvedRecords.$": "$.approvalStatus.approvedRecords"
                        }
                      },
                      "ResultSelector": {
                        "tripsEnriched.$": "$.Payload.tripsEnriched",
                        "stats.$": "$.Payload.stats"
                      },
                      "ResultPath": "$.enrichmentResult",
                      "Next": "UpdateAuditAfterEnrichment"
                    },
                    "UpdateAuditAfterEnrichment": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Update audit with approval and enrichment statistics",
                      "Parameters": {
                        "FunctionName": "mdm-update-audit-history",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "eventType": "approval_update",
                          "approvalStats.$": "$.approvalStatus.stats",
                          "enrichmentStats.$": "$.enrichmentResult"
                        }
                      },
                      "ResultPath": "$.auditResult",
                      "Next": "CheckApprovalStatus"
                    },
                    "PipelineSuccess": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Mark pipeline as completed in audit table",
                      "Parameters": {
                        "FunctionName": "mdm-update-audit-history",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "eventType": "complete",
                          "finalStats": {
                            "totalTripsProcessed.$": "$.totalProcessed",
                            "totalAutoApproved.$": "$.totalAutoApproved",
                            "totalNeedingStewardReview.$": "$.totalNeedingReview"
                          }
                        }
                      },
                      "ResultSelector": {
                        "pipelineRunId.$": "$.Payload.pipelineRunId",
                        "status": "SUCCESS",
                        "auditRecord.$": "$.Payload.auditRecord"
                      },
                      "End": true
                    },
                    "PipelineFailed": {
                      "Type": "Task",
                      "Resource": "arn:aws:states:::lambda:invoke",
                      "Comment": "Mark pipeline as failed in audit table",
                      "Parameters": {
                        "FunctionName": "mdm-update-audit-history",
                        "Payload": {
                          "pipelineRunId.$": "$.pipelineRunId",
                          "eventType": "failed",
                          "error.$": "States.Format('Pipeline execution failed - {}', $.error)"
                        }
                      },
                      "ResultPath": null,
                      "Next": "FailState"
                    },
                    "FailState": {
                      "Type": "Fail",
                      "Error": "PipelineExecutionError",
                      "Cause": "Pipeline execution failed - check CloudWatch logs for details"
                    }
                  }
                }
            RoleArn: !GetAtt IAMRole19.Arn
            StateMachineType: "STANDARD"
            LoggingConfiguration: 
                IncludeExecutionData: false
                Level: "OFF"

    CloudWatchAlarm:
        Type: "AWS::CloudWatch::Alarm"
        Properties:
            AlarmName: "Redshift-Disk-Space-Alarm"
            AlarmDescription: "Alert when disk usage exceeds 75%"
            ActionsEnabled: true
            AlarmActions: 
              - !Ref SNSTopic2
            MetricName: "DataStorage"
            Namespace: "AWS/Redshift-Serverless"
            Statistic: "Average"
            Dimensions: 
              - 
                Name: "Namespace"
                Value: !Ref RedshiftServerlessNamespace
            Period: 900
            EvaluationPeriods: 1
            DatapointsToAlarm: 1
            Threshold: 75
            ComparisonOperator: "GreaterThanThreshold"
            TreatMissingData: "missing"

    CloudWatchAlarm2:
        Type: "AWS::CloudWatch::Alarm"
        Properties:
            AlarmName: "Redshift-High-CPU-Alarm"
            AlarmDescription: "Alert when Redshift CPU exceeds 80%"
            ActionsEnabled: true
            AlarmActions: 
              - !Ref SNSTopic2
            MetricName: "ComputeCapacity"
            Namespace: "AWS/Redshift-Serverless"
            Statistic: "Average"
            Dimensions: 
              - 
                Name: "Workgroup"
                Value: !Ref RedshiftServerlessWorkgroup
            Period: 300
            EvaluationPeriods: 1
            DatapointsToAlarm: 1
            Threshold: 80
            ComparisonOperator: "GreaterThanThreshold"
            TreatMissingData: "missing"

    CloudWatchAlarm3:
        Type: "AWS::CloudWatch::Alarm"
        Properties:
            AlarmName: "Redshift-High-Connections-Alarm"
            AlarmDescription: "Alert when connections near limit"
            ActionsEnabled: true
            AlarmActions: 
              - !Ref SNSTopic2
            MetricName: "DatabaseConnections"
            Namespace: "AWS/Redshift-Serverless"
            Statistic: "Maximum"
            Dimensions: 
              - 
                Name: "DatabaseName"
                Value: !Ref RedshiftServerlessNamespace
              - 
                Name: "Workgroup"
                Value: !Ref RedshiftServerlessWorkgroup
            Period: 300
            EvaluationPeriods: 1
            DatapointsToAlarm: 1
            Threshold: 450
            ComparisonOperator: "GreaterThanThreshold"
            TreatMissingData: "missing"

    CloudWatchDashboard:
        Type: "AWS::CloudWatch::Dashboard"
        Properties:
            DashboardName: "NYC-Taxi-DW-Monitoring"
            DashboardBody: !Sub "{\"widgets\":[{\"type\":\"metric\",\"x\":0,\"y\":0,\"width\":6,\"height\":6,\"properties\":{\"metrics\":[[\"AWS/Redshift-Serverless\",\"DatabaseConnections\",\"DatabaseName\",\"${RedshiftServerlessNamespace}\",\"Workgroup\",\"${RedshiftServerlessWorkgroup}\",{\"stat\":\"SampleCount\",\"region\":\"${AWS::Region}\"}],[\".\",\"QueryRuntimeBreakdown\",\"stage\",\"QueryExecutingRead\",\"DatabaseName\",\"${RedshiftServerlessNamespace}\",\"Workgroup\",\"${RedshiftServerlessWorkgroup}\",{\"region\":\"${AWS::Region}\"}],[\"...\",\"QueryExecutingCopy\",\".\",\".\",\".\",\".\",{\"region\":\"${AWS::Region}\"}],[\".\",\"ComputeCapacity\",\"Workgroup\",\"${RedshiftServerlessWorkgroup}\",{\"region\":\"${AWS::Region}\"}],[\".\",\"RedshiftManagedStorageDsUsedSpace\",\"Namespace\",\"${RedshiftServerlessNamespace}\",{\"region\":\"${AWS::Region}\"}]],\"view\":\"timeSeries\",\"stacked\":false,\"region\":\"${AWS::Region}\",\"stat\":\"Average\",\"period\":604800}},{\"type\":\"metric\",\"x\":6,\"y\":0,\"width\":6,\"height\":3,\"properties\":{\"metrics\":[[\"AWS/Redshift-Serverless\",\"QueryDuration\",\"Workgroup\",\"${RedshiftServerlessWorkgroup}\",\"LatencyRange\",\"Medium\",{\"region\":\"${AWS::Region}\"}]],\"sparkline\":true,\"view\":\"singleValue\",\"region\":\"${AWS::Region}\",\"title\":\"Avg Query Duration (ms)\",\"period\":86400,\"stat\":\"Average\"}},{\"type\":\"metric\",\"x\":6,\"y\":3,\"width\":6,\"height\":6,\"properties\":{\"metrics\":[[\"AWS/S3\",\"NumberOfObjects\",\"BucketName\",\"${S3Bucket}\",\"StorageType\",\"AllStorageTypes\",{\"region\":\"${AWS::Region}\"}]],\"view\":\"timeSeries\",\"stacked\":false,\"region\":\"${AWS::Region}\",\"period\":604800,\"stat\":\"Average\",\"title\":\"S3 Data Lake Storage\"}},{\"type\":\"text\",\"x\":12,\"y\":0,\"width\":6,\"height\":6,\"properties\":{\"markdown\":\"## NYC Taxi Data Warehouse Health\\n**Last Updated:** Auto-refresh every 5 minutes\\n\\n| Metric | Target | Status |\\n|--------|--------|--------|\\n| Redshift CPU | < 80% |  |\\n| Disk Usage | < 70% |  |\\n| Query Time | < 5000ms |  |\\n| Data Quality | > 95% |  |\"}}]}"

    LogsLogGroup:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/crawlers"

    LogsLogGroup2:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"

    LogsLogGroup3:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/data-quality/output"

    LogsLogGroup4:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"

    LogsLogGroup5:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/jobs/logs-v2"

    LogsLogGroup6:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"

    LogsLogGroup7:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"

    LogsLogGroup8:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/sessions/output"

    LogsLogGroup9:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/Jdbc_connection"

    LogsLogGroup10:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"

    LogsLogGroup11:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/testconnection/output/Jdbc_connection"

    LogsLogGroup12:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws-glue/testconnection/output/rds-nyc-taxi-mdm-conn"

    LogsLogGroup13:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws/lambda/GlueDataQualityBlogAlertLambda-0afffdf0f7eb"

    LogsLogGroup14:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws/lambda/SecretsManagerrotation_lambda"

    LogsLogGroup15:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws/lambda/VendorAutoApproveFunction"

    LogsLogGroup16:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws/lambda/mdm-aggregate-review-items"

    LogsLogGroup17:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"

    LogsLogGroup18:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: "RDSOSMetrics"
            RetentionInDays: 30

    LogsLogGroup19:
        Type: "AWS::Logs::LogGroup"
        Properties:
            LogGroupName: !Sub "aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9"

    LogsLogStream:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "crawl_for_curated"

    LogsLogStream2:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "crawler_for_curated"

    LogsLogStream3:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "crawler_for_landing_raw"

    LogsLogStream4:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "crawler_for_rds"

    LogsLogStream5:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "crawler_for_validated"

    LogsLogStream6:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "data-quality-result-crawler"

    LogsLogStream7:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "glue_to_rds"

    LogsLogStream8:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/crawlers"
            LogStreamName: "s3-to-glue"

    LogsLogStream9:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4a3637852d0a84e450f7b4af0b7037b94dbcdc9a"

    LogsLogStream10:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4a3637852d0a84e450f7b4af0b7037b94dbcdc9a_g-4aa9472539efe35803eefbc57ec1cd9eba0dad03_cell2"

    LogsLogStream11:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4a3637852d0a84e450f7b4af0b7037b94dbcdc9a_g-64a04a6648cbd6c375bff83c039439c717d4af9d_cell2"

    LogsLogStream12:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4a3637852d0a84e450f7b4af0b7037b94dbcdc9a_g-b4d3ae9c8fa7daff84dad12f54a92e03f9e44df6_cell2"

    LogsLogStream13:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4a3637852d0a84e450f7b4af0b7037b94dbcdc9a_g-bcaad4143967aba203d8437e22225f087298da6c_cell2"

    LogsLogStream14:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4de83fe292cac5495cbf7c0104131f50c8d42d61"

    LogsLogStream15:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4de83fe292cac5495cbf7c0104131f50c8d42d61_g-4f97b532ba1f047d754b09d9a69d82db5770c1ee_cell2"

    LogsLogStream16:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4de83fe292cac5495cbf7c0104131f50c8d42d61_g-76c921551d11edeb3dcb44cb6db5651f8dbf78d9_cell2"

    LogsLogStream17:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4de83fe292cac5495cbf7c0104131f50c8d42d61_g-f6cc22340b16b8456eaabdd430f7067b6e2412fb_cell2"

    LogsLogStream18:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-4de83fe292cac5495cbf7c0104131f50c8d42d61_g-f8884605c311ea0d869593888b4ce26399577e11_cell2"

    LogsLogStream19:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-541f090e504a3bc90af4331dbf9e0e9e2182de9e"

    LogsLogStream20:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-541f090e504a3bc90af4331dbf9e0e9e2182de9e_g-0100f8047c165b6bedb57b00a0341a0c7298dfa6_cell4"

    LogsLogStream21:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-541f090e504a3bc90af4331dbf9e0e9e2182de9e_g-5fb8708f1964cc471ef26fde554ffd840ff4a932_cell4"

    LogsLogStream22:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-541f090e504a3bc90af4331dbf9e0e9e2182de9e_g-bb721cebaf3f4b85f20e24f24aea2f13ed09f8de_cell4"

    LogsLogStream23:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-541f090e504a3bc90af4331dbf9e0e9e2182de9e_g-e3c2a63b1019d5a97d33abb632694c29a7d18c71_cell4"

    LogsLogStream24:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-88bd1eef80f64bcb6a1a667a184eca7a1fdbb476"

    LogsLogStream25:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-88bd1eef80f64bcb6a1a667a184eca7a1fdbb476_g-16d06d42807995ed3e0ee9357d9455eda596eb5a_cell2"

    LogsLogStream26:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-88bd1eef80f64bcb6a1a667a184eca7a1fdbb476_g-1bd3cac69b61245c730d7676836d68383163d9ec_cell2"

    LogsLogStream27:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-88bd1eef80f64bcb6a1a667a184eca7a1fdbb476_g-68daf644335e9db25286ef0af34bb130e08b6f53_cell2"

    LogsLogStream28:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-88bd1eef80f64bcb6a1a667a184eca7a1fdbb476_g-c18925b5844b6b9ae1b66bdc555317fd7faf83f1_cell2"

    LogsLogStream29:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-a5372645c5740fa0e151650c2e7d43001135cace"

    LogsLogStream30:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-a5372645c5740fa0e151650c2e7d43001135cace_g-2b577f393c3ecbabc38973e3211b8c0006641e25_cell4"

    LogsLogStream31:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-a5372645c5740fa0e151650c2e7d43001135cace_g-4ee6bfe4238d24f51c72e1e3d7ce5c5581ac0477_cell4"

    LogsLogStream32:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-a5372645c5740fa0e151650c2e7d43001135cace_g-8d26c212d8dc428126d077315ff9891c441a9922_cell4"

    LogsLogStream33:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/data-quality/error"
            LogStreamName: "dqrun-a5372645c5740fa0e151650c2e7d43001135cace_g-977f8c21f85f5812071ddb0950e9b2b1f0b1bee2_cell4"

    LogsLogStream34:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/logs-v2"
            LogStreamName: "default-logging-job-run-id-job-insights-rca-driver"

    LogsLogStream35:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b"

    LogsLogStream36:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-168fdfd2a670f481aa10f8e4c29d17d302569f76"

    LogsLogStream37:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-29c4856fc5198d6ac4f478e13d79a3170d716eee"

    LogsLogStream38:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-33444ba6b79f720bb1196d3cd44552989db65d2f"

    LogsLogStream39:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-515bf6aa83d7bddfb372e01fc833353dfc8aa3eb"

    LogsLogStream40:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-914745053ff58446cbdd1ebe51f815e24b5b9d34"

    LogsLogStream41:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-b08569f1f45c19148fed1aea13cd1c6141c0e400"

    LogsLogStream42:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-c15ef21f763134e93ef00a81ccd52fcb26256aee"

    LogsLogStream43:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-dfa1f71bf8fa228b913d040db75674f6fddc3424"

    LogsLogStream44:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_01999311eef07e703bc2c6dca4542865724ea3485e2a8cda2181d57f2c91db8b_g-f985f04158ff5c6a0b43269acf00266dd1825064"

    LogsLogStream45:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a"

    LogsLogStream46:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-168f9e316f8b5fa1ada67ebdb21b92cc8bf0af21"

    LogsLogStream47:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-2c4e5203238c801a8d7c14db00e27efc1338c8ed"

    LogsLogStream48:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-666a9b9c43a91b54d79cf1595af4642fd80a1010"

    LogsLogStream49:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-689e2e407e10d1e755681e6579463e61bcc63dd8"

    LogsLogStream50:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-6e267bc46ef3754be6a34e6f87828310d51c2aa6"

    LogsLogStream51:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-8165d4405fd0d334409908e46aabb3dc6c9247f1"

    LogsLogStream52:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-86a09008e3b51770346d7dff4c8528dce05b1b8b"

    LogsLogStream53:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-ad570079fadbf5b43d0ee9a7f53c66d4b3d24532"

    LogsLogStream54:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_02b3ee194933fd508bc66873caf2fbf5624e71f7d77814ab417f6ec0177fd45a_g-f5b1ad994b82f254edd61fa2178f3214489bcba7"

    LogsLogStream55:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874"

    LogsLogStream56:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-2a2cc444cc957af5cbb7604e2bf63391bfd5f33c"

    LogsLogStream57:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-4fec7e2cb8f6920eeed90e676fc3adff8b690b43"

    LogsLogStream58:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-6702bf52110f55503c5351db71351ec5bea3c277"

    LogsLogStream59:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-7996944bd2ee4098c810492cbfdc353fbc632bb7"

    LogsLogStream60:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-979b0c57f3955b0d0918433440650ffd81941ea9"

    LogsLogStream61:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-a7883b5ac9b9c12af1b5608edb14b6ba3bd38c18"

    LogsLogStream62:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-ae758640ea6e50df865a0ca1a2dde366e8447866"

    LogsLogStream63:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-c14c356e6da43f132840b84a2a22e879ca1c6092"

    LogsLogStream64:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_08a6dc411a3bbd0098a4d65fd3e3b23539c00907d71cfbf69bd6314432ebc874_g-f575f0403bd939305e5c2d74a8e1ae1ff79f325a"

    LogsLogStream65:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca"

    LogsLogStream66:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-483a7253d10fd0e3152097d590d34c3dcfd69892"

    LogsLogStream67:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-632c1000a9301e55077e7a23332e6fbedb7d90df"

    LogsLogStream68:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-66ca33dc6a69f0db2b9ef6bc7b0bab091b05b043"

    LogsLogStream69:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-726dbf639ddee74ae6e8b28986517b25342fc547"

    LogsLogStream70:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-7ebe29f0c77a9279bb1c35d12d9eb171c104a2c1"

    LogsLogStream71:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-8699274a86af793629e2df73eab7397edbd4e135"

    LogsLogStream72:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-b598f9704bb5ac2eefd704f709df573a8c91c8c8"

    LogsLogStream73:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-bb84b2839f1e7be9ef9f59fd897c87c96ef4929e"

    LogsLogStream74:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_0968fe192bc68e0ab454af9e8d237a3b680185a33cd2fac0d63cc9db81b633ca_g-ed5b72ae567cbcf32c78163fca5d17bcd1813b1c"

    LogsLogStream75:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575"

    LogsLogStream76:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-0ae96aef0713a691ae35d67ed41123bb7820cbe0"

    LogsLogStream77:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-0f5816dd272cbc6d05c434c8c711ec389c581959"

    LogsLogStream78:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-1e035ae1400dab10b8d2a3e5e4a8d3c68c6b017f"

    LogsLogStream79:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-3ea48de8520c3c99b1bc393d37ca29213c2560ee"

    LogsLogStream80:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-6567fa2458986c35e8554fb6203cd587121cde4a"

    LogsLogStream81:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-68d9f61933ff59cadfebaa84f908b27a3fff3696"

    LogsLogStream82:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-7b988c30dc9edeb31e48293a512652219b49aaf5"

    LogsLogStream83:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-ae87fb536deca4162919bf8d89b611f7ce28b48a"

    LogsLogStream84:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/error"
            LogStreamName: "jr_09c486c9dc7fba386fc44cda670494b64e6540498736440885bc7ecf82726575_g-d8a7eeda2bb99a955bd3dbcf550bc378f5a1bc01"

    LogsLogStream85:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_0b44fb1a250a643c09c6b0dd32e4ec394c6668dacdf3c033bdcc4de30321b66b"

    LogsLogStream86:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_0c1acd53dd565c206c287169ba4a487fdda7e25b77e97039a973fddf3e36b9f8"

    LogsLogStream87:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_0e157e9290feb541f506e0d87d0c22b4145c9033f6cf25eed5217b7e291f2c45"

    LogsLogStream88:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_119fd51cc5f44330cb5c2ccaabbd4ea6d1329a13b5034166c5186343dc0603ca"

    LogsLogStream89:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_180f0568fe185fdeef0b7cf99877af480f7c01cbb2bbbc183272ba261887532d"

    LogsLogStream90:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_186f36e48e2d9b0c05448c2540f7045fd44b1af22e33c736fb2182807fc0438e"

    LogsLogStream91:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_18c78090a42ba1c8b4a7dd40e51d72ab3810e14eac160f75dbc800ca471bc4e3"

    LogsLogStream92:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_195bab3fb1f21aaf6165515dc6ed1a11ef9410814b4a4e510394f40d4ee2e9f2"

    LogsLogStream93:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_2532c730b3d4348bf183fb4e1ed28cb515e85ff0f3c3e59d72ae81391feef918"

    LogsLogStream94:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_2bb0a08e9905d537ecedfe957775175fd5463fff929e17f13bbbb123858b6304"

    LogsLogStream95:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_2cd8cbfeea2c17457a23303893ec020221ea3656efe62fead67cafa20b49fa0e"

    LogsLogStream96:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_30a0c4f48d3c35e6e847405f58a7830fd70545b5448c050f385f2f12d80b94ff"

    LogsLogStream97:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_30a0e6949bc09e260d7dc46d381c1084e3358800fd0aedbec3a155473490cfc8"

    LogsLogStream98:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_31c9920d33f14952060ba0ef85cbadc48806e7c05ca73910355f2c4dba51b65b"

    LogsLogStream99:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_36a7a1c457cf9357de9cd1291eedbe36fd07e5458843fba9fb425b179dd29059"

    LogsLogStream100:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_36e0a9b7f1ae739e15c143f3a72f604e2df4b1fd844590040c3c7faae2d11fc1"

    LogsLogStream101:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_387c61c316d29185314b6daaa0bebf2514648f27e09e19c6fd9333a41eea0be2"

    LogsLogStream102:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_39861e57883d32ee5337b04dcea162768dd720e90cadc350ae21ea7e167c383c"

    LogsLogStream103:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_3b02a4e947fe86431c48e957e141d382c2f92316f64b1cd20c3a273754356800"

    LogsLogStream104:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_41f45d1b77c4b2b8550a0b574ab45f197b37d36ee1e6cf42899f9622dc42c10b"

    LogsLogStream105:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_4641e18dd3d9652d3ba851faa1cdf9ad8abfa4e2cc8046548e6d27ba4e133455"

    LogsLogStream106:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_4681739b30cd1b760b48d48fa77ad091ca36ec472cba31fef3af70391882a174"

    LogsLogStream107:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_483023acabdf8d64c0288102bca0dd02d06db11ca10c96b6c2b0d26efe5d1fa5"

    LogsLogStream108:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_489e6be42e6b28b876c2e71f697397f8f48baf2262d2b065358dda2ca2aab44b"

    LogsLogStream109:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_4aa965e25842d1c23e74d0f3fbf142ed83b81ab95753c58e0d7d7fe9a4063374"

    LogsLogStream110:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_4c7bb82b224e0d9ee3361a71bc5f0c43f375848f1098e6882f590bdc77008a04"

    LogsLogStream111:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_4d412b67473bda1b1d458d0719e9dde802ef8a34d8a5c8370f39cac28b7d4bdf"

    LogsLogStream112:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_4e704b486fd2dd50eadc3a9e7539846c61cafa05d2897d57440c1d2bb55c7c23"

    LogsLogStream113:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_529c54cf339f2a6d8f3274cd6e4eb52d7c85f3a83aa452ed1ad4c01de09d6d14"

    LogsLogStream114:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_555b9445538f439c62745e053272e935cf70e8f9b64abfab97e1b0008bff8d33"

    LogsLogStream115:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_556bb1d16260b906c97d2b5416b5323a6d02808c26cea6c9efa33081a38fa33f"

    LogsLogStream116:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_5c2706c643126cf8510342d616753fd8bdee096b6c4d1c08f05a952da09aa892"

    LogsLogStream117:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_5cc72bf26d0cb47298c455707487d7c98a66a94dac0963c3ed5d007cac823f64"

    LogsLogStream118:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_5fa1e6ac67436fbe1b2174e23e987a911650db34cfa1a03bd1088a31e20f21bf"

    LogsLogStream119:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_62865981ec64ac571d12eab54510460ef8eadd8257e1b90698b2fa316a457032"

    LogsLogStream120:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_6c4ddd1d118b9a71b8a8c94b108b40e0595b1c3f60e9f1dc090d5d760742f92c"

    LogsLogStream121:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_6f64ee5981aa30e048a9c1a2b64bcb193d14f0bf7650df656d493676433b6bed"

    LogsLogStream122:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_6f8819ba4acafab3fb3e026dd4de4200574e2b74606f12dc98ac100c47254e2f"

    LogsLogStream123:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_737a8a133794f2ad5b4a3094822eb92b730e2382eb3924de6f34716385e785b8"

    LogsLogStream124:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_76fe37861f110f0220df9271a6615cc268b94c7d29fce0bf246756e760fc8127"

    LogsLogStream125:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_787fdd7a410ffc83a8e1eac8cb3befe54a7b18c3bbc352f54a05b450a9a56cf2"

    LogsLogStream126:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_78d6234358014db1ee18569d51938e2fb534f88e5ca95f5e56ff705864978866"

    LogsLogStream127:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_7d12952e72918c0b4950348aad79af8b33c576824745e601f224097c047f2724"

    LogsLogStream128:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_7f431b4911a013c55d1bccb8eeee7a21c3debcd05406a08a8d176ed88573b8dc"

    LogsLogStream129:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/jobs/output"
            LogStreamName: "jr_801e0609973d5e25dd805e4cfe435225e4ab5cf9489170baa91fc56a98855490"

    LogsLogStream130:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-1664e3fd-75df-4a0a-b286-c81d02212c66"

    LogsLogStream131:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-1664e3fd-75df-4a0a-b286-c81d02212c66_g-b899d873d688def4ced6f0d148e175043d7a96c5"

    LogsLogStream132:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-18b558c6-a4ae-47f2-ae2b-80d66cb03d25"

    LogsLogStream133:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-18b558c6-a4ae-47f2-ae2b-80d66cb03d25_g-1ba84325425d907a9cb4b6481b34898eb488a57a"

    LogsLogStream134:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-1b6a8e0f-f4cc-4019-888b-81137d9287e2"

    LogsLogStream135:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-1b6a8e0f-f4cc-4019-888b-81137d9287e2_g-994c5e216c0d0c8c99980705cfe6488ef9d34ac7"

    LogsLogStream136:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-29533131-06a7-4884-b729-a066007936c3"

    LogsLogStream137:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-29533131-06a7-4884-b729-a066007936c3_g-00a8572ab698c8dfe1659af0180380c968743281"

    LogsLogStream138:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-2c1c072b-9371-46ea-9934-f0cdfb15ace6"

    LogsLogStream139:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-2c1c072b-9371-46ea-9934-f0cdfb15ace6_g-824acaeeaab39292bcfa6b9c58e4e557337a01fa"

    LogsLogStream140:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-3255e582-dc2a-49cd-aa44-7ee52c011681"

    LogsLogStream141:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-3255e582-dc2a-49cd-aa44-7ee52c011681_g-e1aea26512a7b1a4dae32cf45b10d15e73b2d4d3"

    LogsLogStream142:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-43f95ec6-25a3-4af2-8b61-10b0f28bd987"

    LogsLogStream143:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-43f95ec6-25a3-4af2-8b61-10b0f28bd987_g-6c9369daee92104be4884bfb6673ec5ff6c5d919"

    LogsLogStream144:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-462c8b55-8eef-44ab-8f08-38bc56aed638"

    LogsLogStream145:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-462c8b55-8eef-44ab-8f08-38bc56aed638_g-b18a4318d4d21dfc7f7d1cd15848aa709409a2ed"

    LogsLogStream146:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-4f77c1cc-afbc-4c0f-9a5d-ec2fe5a08895"

    LogsLogStream147:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-4f77c1cc-afbc-4c0f-9a5d-ec2fe5a08895_g-8d689808d72b92020b81f4d3d8f2fe0efdc7e182"

    LogsLogStream148:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-5e409737-5b53-4d8f-b75f-7db0c06edfad"

    LogsLogStream149:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-5e409737-5b53-4d8f-b75f-7db0c06edfad_g-ae470f905e2eb54180e3456f579ccd3f99a11814"

    LogsLogStream150:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-7df136dc-6719-4ae2-a2ea-aa01f6d3a585"

    LogsLogStream151:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-7df136dc-6719-4ae2-a2ea-aa01f6d3a585_g-bb5329d6b8ec9c8bf2ed7fe67bcb9c793854137e"

    LogsLogStream152:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-83db0dd4-b01e-469d-ba38-ac08b46df013"

    LogsLogStream153:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-83db0dd4-b01e-469d-ba38-ac08b46df013_g-abccbd125da6d2111fb8104193981c5b7cf349ea"

    LogsLogStream154:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-87376c72-4c83-4145-b828-0e00d2948396"

    LogsLogStream155:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-87376c72-4c83-4145-b828-0e00d2948396_g-bf2fc608ae0ae8ae30871ce2149d8091208347f1"

    LogsLogStream156:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-8a32a024-4eb0-4a4e-a882-dfcb70208159"

    LogsLogStream157:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-8a32a024-4eb0-4a4e-a882-dfcb70208159_g-7a6411d1c0bf1bea6e9ba791364d7ab7f0c03ce1"

    LogsLogStream158:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-9b7fa5f8-ac71-4091-a9c2-d2c42ae5bf3d"

    LogsLogStream159:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-9b7fa5f8-ac71-4091-a9c2-d2c42ae5bf3d_g-12ce85decd1e5f102827bde0cb37bb245a993abe"

    LogsLogStream160:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a09aeac4-8183-49bd-97e0-bd6f0b665d12"

    LogsLogStream161:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a09aeac4-8183-49bd-97e0-bd6f0b665d12_g-4c8ee49dde8f2d06e92cc4f1449c107fa3ce7f1e"

    LogsLogStream162:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a0eb3023-5c11-41d1-93dc-c85a8583cc8d"

    LogsLogStream163:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a0eb3023-5c11-41d1-93dc-c85a8583cc8d_g-16bcfdf3a33917ede4e12697f8ddd3a6f20379f7"

    LogsLogStream164:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a2328d41-7e3d-453f-9dea-f2f20fa298d4"

    LogsLogStream165:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a2328d41-7e3d-453f-9dea-f2f20fa298d4_g-5dc669dec6c5d54109c5349c3540ee0c1097f50f"

    LogsLogStream166:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a9d5f067-a2d6-408e-b9bf-8ee590783859"

    LogsLogStream167:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-a9d5f067-a2d6-408e-b9bf-8ee590783859_g-9c157bd1f13b7a6d47313383e9f57e2e516a9d57"

    LogsLogStream168:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-b6980155-20dd-40df-b2a3-a8d373496df1"

    LogsLogStream169:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-b6980155-20dd-40df-b2a3-a8d373496df1_g-76f587a576efaca16e3b27c8accbd24e3ca0e373"

    LogsLogStream170:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-ba1657c2-6312-42cb-807c-bf73b21d0b08"

    LogsLogStream171:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-ba1657c2-6312-42cb-807c-bf73b21d0b08_g-effd9ed43d245b88e7ac5edcdbdf37ab397764cb"

    LogsLogStream172:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-c0bf636e-b80e-4cfa-a396-2515b1a58329"

    LogsLogStream173:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-c0bf636e-b80e-4cfa-a396-2515b1a58329_g-49f248729fa15ced9bcfa642d1c1feb7513b6a73"

    LogsLogStream174:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-d18398d2-8fb6-48e8-8ee5-5bb1ef60a1db"

    LogsLogStream175:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-d18398d2-8fb6-48e8-8ee5-5bb1ef60a1db_g-037d605348c3d33ea35f4762d71e011ca7af8044"

    LogsLogStream176:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-d7ab0a32-6757-4b3c-b53a-c5289abf330e"

    LogsLogStream177:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-d7ab0a32-6757-4b3c-b53a-c5289abf330e_g-99e8572099d357468052aebe684e5c2e378e03ca"

    LogsLogStream178:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-dd5bea4d-ec0a-481c-ac38-39723faf5c46"

    LogsLogStream179:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/error"
            LogStreamName: "glue-studio-datapreview-dd5bea4d-ec0a-481c-ac38-39723faf5c46_g-41d8312d73941717719386740be0c58fe0698314"

    LogsLogStream180:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/output"
            LogStreamName: "glue-studio-datapreview-e751c0c9-5134-4687-bdef-81a9e9b8774c"

    LogsLogStream181:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/output"
            LogStreamName: "glue-studio-datapreview-f4d7c433-7e4c-4378-a822-be5f251f7585"

    LogsLogStream182:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/output"
            LogStreamName: "glue-studio-datapreview-f67957c8-a98f-4880-a849-e8f2715202d2"

    LogsLogStream183:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/sessions/output"
            LogStreamName: "glue-studio-datapreview-fc72ef53-785c-4260-a326-4dfb8cf77aea"

    LogsLogStream184:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/Jdbc_connection"
            LogStreamName: "9-January-2026-5-14-AM-UTC"

    LogsLogStream185:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/Jdbc_connection"
            LogStreamName: "9-January-2026-5-22-AM-UTC"

    LogsLogStream186:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/Jdbc_connection"
            LogStreamName: "9-January-2026-6-45-PM-UTC"

    LogsLogStream187:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"
            LogStreamName: "6-January-2026-1-13-AM-UTC"

    LogsLogStream188:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"
            LogStreamName: "6-January-2026-1-14-AM-UTC"

    LogsLogStream189:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"
            LogStreamName: "6-January-2026-12-51-AM-UTC"

    LogsLogStream190:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"
            LogStreamName: "8-January-2026-9-40-PM-UTC"

    LogsLogStream191:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"
            LogStreamName: "8-January-2026-9-41-PM-UTC"

    LogsLogStream192:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws-glue/testconnection/error/rds-nyc-taxi-mdm-conn"
            LogStreamName: "8-January-2026-9-42-PM-UTC"

    LogsLogStream193:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/GlueDataQualityBlogAlertLambda-0afffdf0f7eb"
            LogStreamName: "2026/01/04/[$LATEST]59e192fbd145408499abcdf708a8e93c"

    LogsLogStream194:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/GlueDataQualityBlogAlertLambda-0afffdf0f7eb"
            LogStreamName: "2026/01/04/[$LATEST]bf75f2d870d445f7a7b9b8a711034375"

    LogsLogStream195:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/SecretsManagerrotation_lambda"
            LogStreamName: "2026/01/21/[$LATEST]baa8cfaae1b64302a248039843d48102"

    LogsLogStream196:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/VendorAutoApproveFunction"
            LogStreamName: "2026/01/06/[$LATEST]da856ffa938e40b981f6a66496def1f1"

    LogsLogStream197:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/VendorAutoApproveFunction"
            LogStreamName: "2026/01/06/[$LATEST]e45bcde0d0da456880711d4066ea5c4f"

    LogsLogStream198:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-aggregate-review-items"
            LogStreamName: "2026/01/16/[$LATEST]2453a11972dd4a4bacb98b4208ebf6b8"

    LogsLogStream199:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]0113fc66acee432d98cd0af5d66a23ae"

    LogsLogStream200:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]03843044fa9445b0a3abc50dd6aad090"

    LogsLogStream201:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]03b984f7e7eb446b9ff7a308344aea20"

    LogsLogStream202:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]0f1bc2e4f8604ce5bb4b703233d4e798"

    LogsLogStream203:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]2101432718e3468f948860e09d7dcb60"

    LogsLogStream204:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]276d7c7b05e24603bdfc34ac2a1e880a"

    LogsLogStream205:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]2d01103db0534a9e967b6c6301e2e5f1"

    LogsLogStream206:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]3ae612f8884848dcab0eecbf5d3fac39"

    LogsLogStream207:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]5fa46f79726f4bb18fec8b7d8d5e8df6"

    LogsLogStream208:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]a181e669be424b5899c76c58b074a656"

    LogsLogStream209:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]a19bf079ad4d4ceba564604a3544ebff"

    LogsLogStream210:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]a610529b45c4403e9232aaaa5a1fae69"

    LogsLogStream211:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]a8806888b40d4c56b5ff8e245b088642"

    LogsLogStream212:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]b8236e27c43b41f488a7909266421f31"

    LogsLogStream213:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]cd5e70778ad34b72855d2aa9106e33bf"

    LogsLogStream214:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]d07682f85f9a486bae0f82da341dc446"

    LogsLogStream215:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]d89167d956cf417bb11e7bc3e1265346"

    LogsLogStream216:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]ed018c67e54947e49991f36bebbd5e01"

    LogsLogStream217:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]f130752705e24bf0af18931a9861f277"

    LogsLogStream218:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/10/[$LATEST]ff07a9b217764b31b1accf6c600b8a46"

    LogsLogStream219:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/11/[$LATEST]03fadd59a08e495b8e2bbcf7c47e8ef5"

    LogsLogStream220:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/11/[$LATEST]197cc42d12844451878a0f07640e1204"

    LogsLogStream221:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/11/[$LATEST]3c26731cbde04375af86f27882e0f62f"

    LogsLogStream222:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/11/[$LATEST]a0f042b7cc344656a7184a5cd10554c5"

    LogsLogStream223:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/11/[$LATEST]af554c45e649480a97554a8a4d9b8689"

    LogsLogStream224:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/11/[$LATEST]bc996110f7ec41059e44769c84d8aa79"

    LogsLogStream225:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/12/[$LATEST]0311dd50126847778ade3a862bdaf817"

    LogsLogStream226:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "/aws/lambda/mdm-validate-input"
            LogStreamName: "2026/01/12/[$LATEST]290e7f7796804223b808213cc6d889d9"

    LogsLogStream227:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "RDSOSMetrics"
            LogStreamName: "db-R43R6LRAWZEOBQ7U7W3A6V2YHA"

    LogsLogStream228:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: "RDSOSMetrics"
            LogStreamName: "db-T7ZP3XI5MZQ62IPEP634I7EL4U"

    LogsLogStream229:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: !Sub "aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9"
            LogStreamName: !Sub "${AWS::AccountId}_CloudTrail_${AWS::Region}"

    LogsLogStream230:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: !Sub "aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9"
            LogStreamName: !Sub "${AWS::AccountId}_CloudTrail_${AWS::Region}_2"

    LogsLogStream231:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: !Sub "aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9"
            LogStreamName: !Sub "${AWS::AccountId}_CloudTrail_${AWS::Region}_3"

    LogsLogStream232:
        Type: "AWS::Logs::LogStream"
        Properties:
            LogGroupName: !Sub "aws-cloudtrail-logs-${AWS::AccountId}-e2a736c9"
            LogStreamName: !Sub "${AWS::AccountId}_CloudTrail_${AWS::Region}_4"

    SNSSubscription:
        Type: "AWS::SNS::Subscription"
        Properties:
            TopicArn: !Ref SNSTopic3
            Endpoint: "biyagudasrinivas9@gmail.com"
            Protocol: "email"
            Region: !Ref AWS::Region

    SNSTopicPolicy:
        Type: "AWS::SNS::TopicPolicy"
        Properties:
            PolicyDocument: !Sub "{\"Version\":\"2008-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__default_statement_ID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Action\":[\"SNS:Publish\",\"SNS:RemovePermission\",\"SNS:SetTopicAttributes\",\"SNS:DeleteTopic\",\"SNS:ListSubscriptionsByTopic\",\"SNS:GetTopicAttributes\",\"SNS:AddPermission\",\"SNS:Subscribe\"],\"Resource\":\"${SNSTopic}\",\"Condition\":{\"StringEquals\":{\"AWS:SourceAccount\":\"${AWS::AccountId}\"}}}]}"
            Topics: 
              - !Ref SNSTopic

    SNSTopicPolicy2:
        Type: "AWS::SNS::TopicPolicy"
        Properties:
            PolicyDocument: !Sub "{\"Version\":\"2008-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__default_statement_ID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Action\":[\"SNS:Publish\",\"SNS:RemovePermission\",\"SNS:SetTopicAttributes\",\"SNS:DeleteTopic\",\"SNS:ListSubscriptionsByTopic\",\"SNS:GetTopicAttributes\",\"SNS:AddPermission\",\"SNS:Subscribe\"],\"Resource\":\"${SNSTopic2}\",\"Condition\":{\"StringEquals\":{\"AWS:SourceAccount\":\"${AWS::AccountId}\"}}}]}"
            Topics: 
              - !Ref SNSTopic2

    SNSTopicPolicy3:
        Type: "AWS::SNS::TopicPolicy"
        Properties:
            PolicyDocument: !Sub "{\"Version\":\"2008-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__default_statement_ID\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"*\"},\"Action\":[\"SNS:Publish\",\"SNS:RemovePermission\",\"SNS:SetTopicAttributes\",\"SNS:DeleteTopic\",\"SNS:ListSubscriptionsByTopic\",\"SNS:GetTopicAttributes\",\"SNS:AddPermission\",\"SNS:Subscribe\"],\"Resource\":\"${SNSTopic3}\",\"Condition\":{\"StringEquals\":{\"AWS:SourceAccount\":\"${AWS::AccountId}\"}}}]}"
            Topics: 
              - !Ref SNSTopic3

    SNSTopic:
        Type: "AWS::SNS::Topic"
        Properties:
            DisplayName: ""
            TopicName: "mdm-data-governance"

    SNSTopic2:
        Type: "AWS::SNS::Topic"
        Properties:
            DisplayName: "NYC Taxi DW Alerts"
            TopicName: !Sub "${RedshiftServerlessNamespace}-alerts"

    SNSTopic3:
        Type: "AWS::SNS::Topic"
        Properties:
            DisplayName: ""
            TopicName: "mdm-steward-alerts"

    SQSQueue:
        Type: "AWS::SQS::Queue"
        Properties:
            DelaySeconds: "0"
            MaximumMessageSize: "1048576"
            MessageRetentionPeriod: "345600"
            ReceiveMessageWaitTimeSeconds: "0"
            VisibilityTimeout: "30"
            QueueName: "VendorReviewQueue"

    SQSQueuePolicy:
        Type: "AWS::SQS::QueuePolicy"
        Properties:
            PolicyDocument: !Sub "{\"Version\":\"2012-10-17\",\"Id\":\"__default_policy_ID\",\"Statement\":[{\"Sid\":\"__owner_statement\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::${AWS::AccountId}:root\"},\"Action\":\"SQS:*\",\"Resource\":\"${SQSQueue}\"}]}"
            Queues: 
              - !Sub "https://sqs.${AWS::Region}.amazonaws.com/${AWS::AccountId}/${SQSQueue.QueueName}"

    GlueDatabase:
        Type: "AWS::Glue::Database"
        Properties:
            DatabaseInput: 
                Name: "data-quality-result-database"
            CatalogId: !Ref "AWS::AccountId"

    GlueDatabase2:
        Type: "AWS::Glue::Database"
        Properties:
            DatabaseInput: 
                Name: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"

    GlueDatabase3:
        Type: "AWS::Glue::Database"
        Properties:
            DatabaseInput: 
                Name: "default"
                Description: "Default Hive database"
                LocationUri: "file:/user/hive/warehouse"
            CatalogId: !Ref "AWS::AccountId"

    GlueDatabase4:
        Type: "AWS::Glue::Database"
        Properties:
            DatabaseInput: 
                Name: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"

    GlueDatabase5:
        Type: "AWS::Glue::Database"
        Properties:
            DatabaseInput: 
                Name: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"

    GlueTable:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    sizeKey: "90440868"
                    objectCount: "61"
                    UPDATED_BY_CRAWLER: "s3-to-glue"
                    CRAWL_RUN_ID: "eb5799c3-80d4-4e79-932b-723b7e955365"
                    recordCount: "2557706"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "48"
                    "partition_filtering.enabled": "true"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "parquet"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "90440868"
                        objectCount: "61"
                        UPDATED_BY_CRAWLER: "s3-to-glue"
                        CRAWL_RUN_ID: "eb5799c3-80d4-4e79-932b-723b7e955365"
                        recordCount: "2557706"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "48"
                        "partition_filtering.enabled": "true"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                PartitionKeys: 
                  - 
                    Name: "pickup_year"
                    Type: "string"
                  - 
                    Name: "pickup_month"
                    Type: "string"
                  - 
                    Name: "pickup_day"
                    Type: "string"
                Retention: 0
                Name: "trip_level"

    GlueTable2:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    sizeKey: "97696709"
                    objectCount: "1130"
                    UPDATED_BY_CRAWLER: "crawler_for_curated"
                    CRAWL_RUN_ID: "79b8c50c-2e55-4a11-9f86-63f2ade34ab5"
                    recordCount: "1101235"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "99"
                    "partition_filtering.enabled": "true"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "parquet"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "97696709"
                        objectCount: "1130"
                        UPDATED_BY_CRAWLER: "crawler_for_curated"
                        CRAWL_RUN_ID: "79b8c50c-2e55-4a11-9f86-63f2ade34ab5"
                        recordCount: "1101235"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "99"
                        "partition_filtering.enabled": "true"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                PartitionKeys: 
                  - 
                    Name: "pickup_year"
                    Type: "string"
                  - 
                    Name: "pickup_month"
                    Type: "string"
                  - 
                    Name: "pickup_day"
                    Type: "string"
                Retention: 0
                Name: "golden_kpis"

    GlueTable3:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    sizeKey: "90440868"
                    objectCount: "61"
                    UPDATED_BY_CRAWLER: "crawler_for_curated"
                    CRAWL_RUN_ID: "79b8c50c-2e55-4a11-9f86-63f2ade34ab5"
                    recordCount: "2557706"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "48"
                    "partition_filtering.enabled": "true"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "parquet"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "90440868"
                        objectCount: "61"
                        UPDATED_BY_CRAWLER: "crawler_for_curated"
                        CRAWL_RUN_ID: "79b8c50c-2e55-4a11-9f86-63f2ade34ab5"
                        recordCount: "2557706"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "48"
                        "partition_filtering.enabled": "true"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                PartitionKeys: 
                  - 
                    Name: "pickup_year"
                    Type: "string"
                  - 
                    Name: "pickup_month"
                    Type: "string"
                  - 
                    Name: "pickup_day"
                    Type: "string"
                Retention: 0
                Name: "golden_trip_level"

    GlueTable4:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    "skip.header.line.count": "1"
                    sizeKey: "12331"
                    UPDATED_BY_CRAWLER: "crawler_for_landing_raw"
                    recordCount: "342"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "36"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "csv"
                    columnsOrdered: "true"
                    delimiter: ","
                    areColumnsQuoted: "false"
                    CRAWL_RUN_ID: "06c28d6f-9625-4451-94d7-a2cf11c218ef"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "locationid"
                        Type: "bigint"
                      - 
                        Name: "borough"
                        Type: "string"
                      - 
                        Name: "zone"
                        Type: "string"
                      - 
                        Name: "service_zone"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/landing/yellow/taxi_zone_lookup.csv"
                    InputFormat: "org.apache.hadoop.mapred.TextInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                        Parameters: 
                            "field.delim": ","
                    Parameters: 
                        "skip.header.line.count": "1"
                        sizeKey: "12331"
                        UPDATED_BY_CRAWLER: "crawler_for_landing_raw"
                        recordCount: "342"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "36"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "csv"
                        columnsOrdered: "true"
                        delimiter: ","
                        areColumnsQuoted: "false"
                        CRAWL_RUN_ID: "06c28d6f-9625-4451-94d7-a2cf11c218ef"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "taxi_zone_lookup_csv"

    GlueTable5:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    sizeKey: "74941181"
                    objectCount: "61"
                    UPDATED_BY_CRAWLER: "crawler_for_validated"
                    CRAWL_RUN_ID: "8f4c3246-12f2-49d8-91b2-460de9e293a2"
                    recordCount: "2557706"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "41"
                    "partition_filtering.enabled": "true"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "parquet"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "74941181"
                        objectCount: "61"
                        UPDATED_BY_CRAWLER: "crawler_for_validated"
                        CRAWL_RUN_ID: "8f4c3246-12f2-49d8-91b2-460de9e293a2"
                        recordCount: "2557706"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "41"
                        "partition_filtering.enabled": "true"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                PartitionKeys: 
                  - 
                    Name: "pickup_year"
                    Type: "string"
                  - 
                    Name: "pickup_month"
                    Type: "string"
                  - 
                    Name: "pickup_day"
                    Type: "string"
                Retention: 0
                Name: "yellow"

    GlueTable6:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    "skip.header.line.count": "1"
                    sizeKey: "373176581"
                    UPDATED_BY_CRAWLER: "crawler_for_landing_raw"
                    recordCount: "2248051"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "166"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "csv"
                    columnsOrdered: "true"
                    delimiter: ","
                    areColumnsQuoted: "false"
                    CRAWL_RUN_ID: "06c28d6f-9625-4451-94d7-a2cf11c218ef"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "bigint"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "string"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "string"
                      - 
                        Name: "passenger_count"
                        Type: "bigint"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "bigint"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "bigint"
                      - 
                        Name: "dolocationid"
                        Type: "bigint"
                      - 
                        Name: "payment_type"
                        Type: "bigint"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                    Location: !Sub "s3://${S3Bucket}/landing/yellow/yellow_tripdata_.csv"
                    InputFormat: "org.apache.hadoop.mapred.TextInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe"
                        Parameters: 
                            "field.delim": ","
                    Parameters: 
                        "skip.header.line.count": "1"
                        sizeKey: "373176581"
                        UPDATED_BY_CRAWLER: "crawler_for_landing_raw"
                        recordCount: "2248051"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "166"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "csv"
                        columnsOrdered: "true"
                        delimiter: ","
                        areColumnsQuoted: "false"
                        CRAWL_RUN_ID: "06c28d6f-9625-4451-94d7-a2cf11c218ef"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "yellow_tripdata__csv"

    GlueTable7:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "pickup_month"
                        Type: "string"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "is_long_trip"
                        Type: "tinyint"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "pickup_day"
                        Type: "string"
                      - 
                        Name: "high_tip_flag"
                        Type: "tinyint"
                      - 
                        Name: "trip_id"
                        Type: "bigint"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pickup_year"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "is_short_trip"
                        Type: "tinyint"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                    Location: "nyc_taxi_mdm.mdm_golden_trip_level"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_golden_trip_level"

    GlueTable8:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "match_confidence"
                        Type: "decimal(5,2)"
                      - 
                        Name: "source_system"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "ratecode_id"
                        Type: "int"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "created_by"
                        Type: "string"
                      - 
                        Name: "lifecycle_state"
                        Type: "string"
                      - 
                        Name: "approved_by"
                        Type: "string"
                      - 
                        Name: "source_ratecode_id"
                        Type: "int"
                      - 
                        Name: "updated_at"
                        Type: "timestamp"
                      - 
                        Name: "approved_at"
                        Type: "timestamp"
                      - 
                        Name: "change_id"
                        Type: "bigint"
                      - 
                        Name: "updated_by"
                        Type: "string"
                    Location: "nyc_taxi_mdm.mdm_ratecode"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_ratecode"

    GlueTable9:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "ratecode_id_2"
                        Type: "int"
                      - 
                        Name: "decided_at"
                        Type: "timestamp"
                      - 
                        Name: "confidence_level"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "match_score"
                        Type: "decimal(5,2)"
                      - 
                        Name: "decision_reason"
                        Type: "string"
                      - 
                        Name: "steward_decision"
                        Type: "string"
                      - 
                        Name: "queue_id"
                        Type: "int"
                      - 
                        Name: "ratecode_id_1"
                        Type: "int"
                      - 
                        Name: "decided_by"
                        Type: "string"
                    Location: "nyc_taxi_mdm.mdm_ratecode_dedup_queue"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_ratecode_dedup_queue"

    GlueTable10:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "match_confidence"
                        Type: "decimal(5,2)"
                      - 
                        Name: "source_system"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "ratecode_id"
                        Type: "int"
                      - 
                        Name: "change_type"
                        Type: "string"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "history_id"
                        Type: "int"
                      - 
                        Name: "created_by"
                        Type: "string"
                      - 
                        Name: "lifecycle_state"
                        Type: "string"
                      - 
                        Name: "approved_by"
                        Type: "string"
                      - 
                        Name: "change_reason"
                        Type: "string"
                      - 
                        Name: "approved_at"
                        Type: "timestamp"
                      - 
                        Name: "change_id"
                        Type: "bigint"
                    Location: "nyc_taxi_mdm.mdm_ratecode_history"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_ratecode_history"

    GlueTable11:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "match_confidence"
                        Type: "decimal(5,2)"
                      - 
                        Name: "source_system"
                        Type: "string"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "created_by"
                        Type: "string"
                      - 
                        Name: "lifecycle_state"
                        Type: "string"
                      - 
                        Name: "approved_by"
                        Type: "string"
                      - 
                        Name: "updated_at"
                        Type: "timestamp"
                      - 
                        Name: "approved_at"
                        Type: "timestamp"
                      - 
                        Name: "vendor_id"
                        Type: "int"
                      - 
                        Name: "change_id"
                        Type: "bigint"
                      - 
                        Name: "updated_by"
                        Type: "string"
                      - 
                        Name: "source_vendor_id"
                        Type: "int"
                    Location: "nyc_taxi_mdm.mdm_vendor"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_vendor"

    GlueTable12:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "decided_at"
                        Type: "timestamp"
                      - 
                        Name: "confidence_level"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "match_score"
                        Type: "decimal(5,2)"
                      - 
                        Name: "decision_reason"
                        Type: "string"
                      - 
                        Name: "steward_decision"
                        Type: "string"
                      - 
                        Name: "vendor_id_2"
                        Type: "int"
                      - 
                        Name: "vendor_id_1"
                        Type: "int"
                      - 
                        Name: "queue_id"
                        Type: "int"
                      - 
                        Name: "decided_by"
                        Type: "string"
                    Location: "nyc_taxi_mdm.mdm_vendor_dedup_queue"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_vendor_dedup_queue"

    GlueTable13:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "match_confidence"
                        Type: "decimal(5,2)"
                      - 
                        Name: "source_system"
                        Type: "string"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "change_type"
                        Type: "string"
                      - 
                        Name: "history_id"
                        Type: "int"
                      - 
                        Name: "created_by"
                        Type: "string"
                      - 
                        Name: "lifecycle_state"
                        Type: "string"
                      - 
                        Name: "approved_by"
                        Type: "string"
                      - 
                        Name: "change_reason"
                        Type: "string"
                      - 
                        Name: "approved_at"
                        Type: "timestamp"
                      - 
                        Name: "change_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_id"
                        Type: "int"
                    Location: "nyc_taxi_mdm.mdm_vendor_history"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "07df2f88-0b06-4ed0-a1d4-ab13e46b604d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_vendor_history"

    GlueTable14:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "match_confidence"
                        Type: "decimal(5,2)"
                      - 
                        Name: "source_zone_id"
                        Type: "int"
                      - 
                        Name: "source_system"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "zone_name"
                        Type: "string"
                      - 
                        Name: "created_by"
                        Type: "string"
                      - 
                        Name: "zone_id"
                        Type: "int"
                      - 
                        Name: "lifecycle_state"
                        Type: "string"
                      - 
                        Name: "approved_by"
                        Type: "string"
                      - 
                        Name: "updated_at"
                        Type: "timestamp"
                      - 
                        Name: "approved_at"
                        Type: "timestamp"
                      - 
                        Name: "change_id"
                        Type: "bigint"
                      - 
                        Name: "updated_by"
                        Type: "string"
                    Location: "nyc_taxi_mdm.mdm_zone"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_zone"

    GlueTable15:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "zone_id_1"
                        Type: "int"
                      - 
                        Name: "zone_id_2"
                        Type: "int"
                      - 
                        Name: "decided_at"
                        Type: "timestamp"
                      - 
                        Name: "confidence_level"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "match_score"
                        Type: "decimal(5,2)"
                      - 
                        Name: "decision_reason"
                        Type: "string"
                      - 
                        Name: "steward_decision"
                        Type: "string"
                      - 
                        Name: "queue_id"
                        Type: "int"
                      - 
                        Name: "decided_by"
                        Type: "string"
                    Location: "nyc_taxi_mdm.mdm_zone_dedup_queue"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_zone_dedup_queue"

    GlueTable16:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data_migrate_rds"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    UPDATED_BY_CRAWLER: "glue_to_rds"
                    CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                    CrawlerSchemaSerializerVersion: "1.0"
                    connectionName: "Mysql connection"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "mysql"
                    typeOfData: "table"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "match_confidence"
                        Type: "decimal(5,2)"
                      - 
                        Name: "source_system"
                        Type: "string"
                      - 
                        Name: "created_at"
                        Type: "timestamp"
                      - 
                        Name: "zone_name"
                        Type: "string"
                      - 
                        Name: "change_type"
                        Type: "string"
                      - 
                        Name: "history_id"
                        Type: "int"
                      - 
                        Name: "created_by"
                        Type: "string"
                      - 
                        Name: "zone_id"
                        Type: "int"
                      - 
                        Name: "lifecycle_state"
                        Type: "string"
                      - 
                        Name: "approved_by"
                        Type: "string"
                      - 
                        Name: "change_reason"
                        Type: "string"
                      - 
                        Name: "approved_at"
                        Type: "timestamp"
                      - 
                        Name: "change_id"
                        Type: "bigint"
                    Location: "nyc_taxi_mdm.mdm_zone_history"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        Parameters: {}
                    Parameters: 
                        UPDATED_BY_CRAWLER: "glue_to_rds"
                        CRAWL_RUN_ID: "1f4d0a51-8201-487f-b7b7-4113e2b1e38d"
                        CrawlerSchemaSerializerVersion: "1.0"
                        connectionName: "Mysql connection"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "mysql"
                        typeOfData: "table"
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "nyc_taxi_mdm_mdm_zone_history"

    GlueTable17:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data-quality-result-database"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                ViewOriginalText: "/* Presto View: eyJvcmlnaW5hbFNxbCI6IlNFTEVDVFxuICBcImRhdGFiYXNlbmFtZVwiXG4sIFwidGFibGVuYW1lXCJcbiwgXCJydWxlc2V0X25hbWVcIlxuLCBcInJ1bmlkXCJcbiwgXCJyZXN1bHRpZFwiXG4sIFwic3RhdGVcIlxuLCBcIm51bXJ1bGVzc3VjY2VlZGVkXCJcbiwgXCJudW1ydWxlc2ZhaWxlZFwiXG4sIFwibnVtcnVsZXNza2lwcGVkXCJcbiwgXCJzY29yZVwiXG4sIFwieWVhclwiXG4sIFwibW9udGhcIlxuLCBcImRheVwiXG4sIHJ1bnMubmFtZVxuLCBydW5zLnJlc3VsdFxuLCBydW5zLmV2YWx1YXRpb25tZXNzYWdlXG4sIHJ1bnMuRGVzY3JpcHRpb25cbkZST01cbiAgKFwiZHFfZ2x1ZWRhdGFxdWFsaXR5bG9nc1wiXG5DUk9TUyBKT0lOIFVOTkVTVChyZXN1bHRydW4pIHQgKHJ1bnMpKVxuIiwiY2F0YWxvZyI6ImF3c2RhdGFjYXRhbG9nIiwic2NoZW1hIjoiZGF0YS1xdWFsaXR5LXJlc3VsdC1kYXRhYmFzZSIsImNvbHVtbnMiOlt7Im5hbWUiOiJkYXRhYmFzZW5hbWUiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6InRhYmxlbmFtZSIsInR5cGUiOiJ2YXJjaGFyIn0seyJuYW1lIjoicnVsZXNldF9uYW1lIiwidHlwZSI6InZhcmNoYXIifSx7Im5hbWUiOiJydW5pZCIsInR5cGUiOiJ2YXJjaGFyIn0seyJuYW1lIjoicmVzdWx0aWQiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6InN0YXRlIiwidHlwZSI6InZhcmNoYXIifSx7Im5hbWUiOiJudW1ydWxlc3N1Y2NlZWRlZCIsInR5cGUiOiJ2YXJjaGFyIn0seyJuYW1lIjoibnVtcnVsZXNmYWlsZWQiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6Im51bXJ1bGVzc2tpcHBlZCIsInR5cGUiOiJ2YXJjaGFyIn0seyJuYW1lIjoic2NvcmUiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6InllYXIiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6Im1vbnRoIiwidHlwZSI6InZhcmNoYXIifSx7Im5hbWUiOiJkYXkiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6Im5hbWUiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6InJlc3VsdCIsInR5cGUiOiJ2YXJjaGFyIn0seyJuYW1lIjoiZXZhbHVhdGlvbm1lc3NhZ2UiLCJ0eXBlIjoidmFyY2hhciJ9LHsibmFtZSI6IkRlc2NyaXB0aW9uIiwidHlwZSI6InZhcmNoYXIifV0sIm93bmVyIjoiNDczMTU3ODAxNzUyIiwicnVuQXNJbnZva2VyIjpmYWxzZSwicHJvcGVydGllcyI6e30sImlzUHJvdGVjdGVkIjpmYWxzZSwiaXNNdWx0aURpYWxlY3QiOmZhbHNlfQ== */"
                TableType: "VIRTUAL_VIEW"
                Parameters: 
                    presto_view: "true"
                    comment: "Presto View"
                ViewExpandedText: "/* Presto View */"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "databasename"
                        Type: "string"
                      - 
                        Name: "tablename"
                        Type: "string"
                      - 
                        Name: "ruleset_name"
                        Type: "string"
                      - 
                        Name: "runid"
                        Type: "string"
                      - 
                        Name: "resultid"
                        Type: "string"
                      - 
                        Name: "state"
                        Type: "string"
                      - 
                        Name: "numrulessucceeded"
                        Type: "string"
                      - 
                        Name: "numrulesfailed"
                        Type: "string"
                      - 
                        Name: "numrulesskipped"
                        Type: "string"
                      - 
                        Name: "score"
                        Type: "string"
                      - 
                        Name: "year"
                        Type: "string"
                      - 
                        Name: "month"
                        Type: "string"
                      - 
                        Name: "day"
                        Type: "string"
                      - 
                        Name: "name"
                        Type: "string"
                      - 
                        Name: "result"
                        Type: "string"
                      - 
                        Name: "evaluationmessage"
                        Type: "string"
                      - 
                        Name: "description"
                        Type: "string"
                    Location: ""
                    Compressed: false
                    NumberOfBuckets: 0
                    SerdeInfo: {}
                    StoredAsSubDirectories: false
                Retention: 0
                Name: "data_quality_result_view"

    GlueTable18:
        Type: "AWS::Glue::Table"
        Properties:
            DatabaseName: "data-quality-result-database"
            CatalogId: !Ref "AWS::AccountId"
            TableInput: 
                Owner: "owner"
                TableType: "EXTERNAL_TABLE"
                Parameters: 
                    sizeKey: "1502"
                    objectCount: "2"
                    UPDATED_BY_CRAWLER: "data-quality-result-crawler"
                    CRAWL_RUN_ID: "a4396d24-d1ee-4108-998f-0b97f158be88"
                    recordCount: "2"
                    CrawlerSchemaSerializerVersion: "1.0"
                    averageRecordSize: "751"
                    "partition_filtering.enabled": "true"
                    compressionType: "none"
                    CrawlerSchemaDeserializerVersion: "1.0"
                    classification: "json"
                    typeOfData: "file"
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "ruleset_name"
                        Type: "string"
                      - 
                        Name: "databasename"
                        Type: "string"
                      - 
                        Name: "tablename"
                        Type: "string"
                      - 
                        Name: "runid"
                        Type: "string"
                      - 
                        Name: "resultid"
                        Type: "string"
                      - 
                        Name: "state"
                        Type: "string"
                      - 
                        Name: "score"
                        Type: "string"
                      - 
                        Name: "numrulessucceeded"
                        Type: "string"
                      - 
                        Name: "numrulesfailed"
                        Type: "string"
                      - 
                        Name: "numrulesskipped"
                        Type: "string"
                      - 
                        Name: "resultrun"
                        Type: "array<struct<Name:string,Result:string,Description:string,EvaluationMessage:string>>"
                    Location: !Sub "s3://${S3Bucket5}/gluedataqualitylogs/"
                    InputFormat: "org.apache.hadoop.mapred.TextInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.openx.data.jsonserde.JsonSerDe"
                        Parameters: 
                            paths: "databaseName,numRulesFailed,numRulesSkipped,numRulesSucceeded,resultId,resultrun,ruleset_name,runId,score,state,tableName"
                    Parameters: 
                        sizeKey: "1502"
                        objectCount: "2"
                        UPDATED_BY_CRAWLER: "data-quality-result-crawler"
                        CRAWL_RUN_ID: "a4396d24-d1ee-4108-998f-0b97f158be88"
                        recordCount: "2"
                        CrawlerSchemaSerializerVersion: "1.0"
                        averageRecordSize: "751"
                        "partition_filtering.enabled": "true"
                        compressionType: "none"
                        CrawlerSchemaDeserializerVersion: "1.0"
                        classification: "json"
                        typeOfData: "file"
                    StoredAsSubDirectories: false
                PartitionKeys: 
                  - 
                    Name: "year"
                    Type: "string"
                  - 
                    Name: "month"
                    Type: "string"
                  - 
                    Name: "day"
                    Type: "string"
                Retention: 0
                Name: "dq_gluedataqualitylogs"

    GluePartition:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=12/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2539376"
                        objectCount: "2"
                        recordCount: "88960"
                        averageRecordSize: "42"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition2:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=7/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "9133"
                        objectCount: "1"
                        recordCount: "13"
                        averageRecordSize: "192"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition3:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=16/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2355763"
                        objectCount: "2"
                        recordCount: "80278"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition4:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=28/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2561856"
                        objectCount: "2"
                        recordCount: "87008"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition5:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=3/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2165302"
                        objectCount: "2"
                        recordCount: "71809"
                        averageRecordSize: "45"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition6:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=29/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2443240"
                        objectCount: "2"
                        recordCount: "81754"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition7:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=9/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "7803"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1023"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition8:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=22/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2457617"
                        objectCount: "2"
                        recordCount: "82958"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition9:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=9/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2205185"
                        objectCount: "1"
                        recordCount: "75311"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition10:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=14/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2672226"
                        objectCount: "2"
                        recordCount: "92850"
                        averageRecordSize: "42"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition11:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=23/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2461481"
                        objectCount: "2"
                        recordCount: "84161"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition12:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=2/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2355569"
                        objectCount: "2"
                        recordCount: "80585"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition13:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=4/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2291666"
                        objectCount: "2"
                        recordCount: "77805"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition14:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=21/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2557614"
                        objectCount: "2"
                        recordCount: "87872"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition15:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2009/pickup_month=1/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "7805"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1025"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition16:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=6/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2691241"
                        objectCount: "2"
                        recordCount: "95391"
                        averageRecordSize: "42"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition17:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=25/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2206731"
                        objectCount: "1"
                        recordCount: "74388"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition18:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=8/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2425046"
                        objectCount: "2"
                        recordCount: "82633"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition19:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=11/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2267674"
                        objectCount: "2"
                        recordCount: "76247"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition20:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=19/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2405200"
                        objectCount: "2"
                        recordCount: "82627"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition21:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=26/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2456814"
                        objectCount: "2"
                        recordCount: "83807"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition22:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=17/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2191045"
                        objectCount: "1"
                        recordCount: "73884"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition23:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=30/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2361853"
                        objectCount: "2"
                        recordCount: "79877"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition24:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=7/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2605565"
                        objectCount: "2"
                        recordCount: "90113"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition25:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2453663"
                        objectCount: "1"
                        recordCount: "84046"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition26:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=15/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2469331"
                        objectCount: "2"
                        recordCount: "83451"
                        averageRecordSize: "44"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition27:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=18/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2187283"
                        objectCount: "2"
                        recordCount: "72794"
                        averageRecordSize: "45"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition28:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=27/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2540371"
                        objectCount: "2"
                        recordCount: "86863"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition29:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=10/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2076866"
                        objectCount: "2"
                        recordCount: "68120"
                        averageRecordSize: "45"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition30:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=24/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2250988"
                        objectCount: "2"
                        recordCount: "74491"
                        averageRecordSize: "45"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition31:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=20/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2744169"
                        objectCount: "2"
                        recordCount: "97648"
                        averageRecordSize: "41"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition32:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=5/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2562469"
                        objectCount: "2"
                        recordCount: "89328"
                        averageRecordSize: "43"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition33:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=13/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2777430"
                        objectCount: "2"
                        recordCount: "99105"
                        averageRecordSize: "41"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition34:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "yellow"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "string"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                    Location: !Sub "s3://${S3Bucket}/validated/yellow/pickup_year=2025/pickup_month=8/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2175806"
                        objectCount: "2"
                        recordCount: "71527"
                        averageRecordSize: "45"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition35:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=19/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2905672"
                        objectCount: "2"
                        recordCount: "82627"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition36:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=29/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2954465"
                        objectCount: "2"
                        recordCount: "81754"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition37:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=5/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3093122"
                        objectCount: "2"
                        recordCount: "89328"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition38:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=24/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2714363"
                        objectCount: "2"
                        recordCount: "74491"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition39:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=7/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "14140"
                        objectCount: "1"
                        recordCount: "13"
                        averageRecordSize: "306"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition40:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=13/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3355247"
                        objectCount: "2"
                        recordCount: "99105"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition41:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=20/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3323153"
                        objectCount: "2"
                        recordCount: "97648"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition42:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2009/pickup_month=1/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "12069"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1636"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition43:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=16/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2836130"
                        objectCount: "2"
                        recordCount: "80278"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition44:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=7/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3144778"
                        objectCount: "2"
                        recordCount: "90113"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition45:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=9/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2648702"
                        objectCount: "1"
                        recordCount: "75311"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition46:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=11/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2739040"
                        objectCount: "2"
                        recordCount: "76247"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition47:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=21/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3092022"
                        objectCount: "2"
                        recordCount: "87872"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition48:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=2/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2834392"
                        objectCount: "2"
                        recordCount: "80585"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition49:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=17/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2635346"
                        objectCount: "1"
                        recordCount: "73884"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition50:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=8/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2923308"
                        objectCount: "2"
                        recordCount: "82633"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition51:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=27/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3072205"
                        objectCount: "2"
                        recordCount: "86863"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition52:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=23/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2966581"
                        objectCount: "2"
                        recordCount: "84161"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition53:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2954846"
                        objectCount: "1"
                        recordCount: "84046"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition54:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=15/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2977261"
                        objectCount: "2"
                        recordCount: "83451"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition55:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=4/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2767013"
                        objectCount: "2"
                        recordCount: "77805"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition56:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=6/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3250994"
                        objectCount: "2"
                        recordCount: "95391"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition57:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=14/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3226813"
                        objectCount: "2"
                        recordCount: "92850"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition58:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=28/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3097521"
                        objectCount: "2"
                        recordCount: "87008"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition59:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=12/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3068298"
                        objectCount: "2"
                        recordCount: "88960"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition60:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=18/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2639429"
                        objectCount: "2"
                        recordCount: "72794"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition61:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=30/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2852028"
                        objectCount: "2"
                        recordCount: "79877"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition62:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=22/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2966870"
                        objectCount: "2"
                        recordCount: "82958"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition63:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=10/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2499474"
                        objectCount: "2"
                        recordCount: "68120"
                        averageRecordSize: "52"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition64:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=3/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2609061"
                        objectCount: "2"
                        recordCount: "71809"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition65:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=25/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2660865"
                        objectCount: "1"
                        recordCount: "74388"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition66:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=9/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "12209"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1653"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition67:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=26/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2969289"
                        objectCount: "2"
                        recordCount: "83807"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition68:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_trip_level"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2624162"
                        objectCount: "2"
                        recordCount: "71527"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition69:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=3/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2983361"
                        objectCount: "36"
                        recordCount: "33588"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition70:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=29/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3263297"
                        objectCount: "36"
                        recordCount: "37214"
                        averageRecordSize: "101"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition71:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=2/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3178881"
                        objectCount: "36"
                        recordCount: "36184"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition72:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=28/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3294935"
                        objectCount: "36"
                        recordCount: "37313"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition73:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=9/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3088268"
                        objectCount: "36"
                        recordCount: "35108"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition74:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=5/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3110838"
                        objectCount: "36"
                        recordCount: "34599"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition75:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=4/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2936386"
                        objectCount: "36"
                        recordCount: "32627"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition76:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3082062"
                        objectCount: "36"
                        recordCount: "35123"
                        averageRecordSize: "99"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition77:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=13/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3233459"
                        objectCount: "36"
                        recordCount: "36164"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition78:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=6/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3234158"
                        objectCount: "36"
                        recordCount: "36266"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition79:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=30/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3210356"
                        objectCount: "36"
                        recordCount: "36666"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition80:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=15/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3238730"
                        objectCount: "36"
                        recordCount: "36920"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition81:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3188763"
                        objectCount: "36"
                        recordCount: "36170"
                        averageRecordSize: "101"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition82:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=18/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2912040"
                        objectCount: "36"
                        recordCount: "32427"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition83:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=26/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3170260"
                        objectCount: "36"
                        recordCount: "35611"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition84:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=11/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2958949"
                        objectCount: "36"
                        recordCount: "33034"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition85:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=17/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3036152"
                        objectCount: "36"
                        recordCount: "34287"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition86:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=23/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3264676"
                        objectCount: "36"
                        recordCount: "37270"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition87:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=20/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3252238"
                        objectCount: "36"
                        recordCount: "36427"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition88:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=16/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3179268"
                        objectCount: "36"
                        recordCount: "36221"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition89:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=10/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2928095"
                        objectCount: "36"
                        recordCount: "32995"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition90:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=19/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3078220"
                        objectCount: "36"
                        recordCount: "34395"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition91:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=22/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3243476"
                        objectCount: "36"
                        recordCount: "36944"
                        averageRecordSize: "101"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition92:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=25/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3017800"
                        objectCount: "36"
                        recordCount: "33856"
                        averageRecordSize: "101"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition93:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=24/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3092817"
                        objectCount: "36"
                        recordCount: "35105"
                        averageRecordSize: "100"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition94:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=12/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3118766"
                        objectCount: "36"
                        recordCount: "34791"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition95:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=9/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "8949"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1150"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition96:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=7/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "105601"
                        objectCount: "12"
                        recordCount: "13"
                        averageRecordSize: "1070"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition97:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=21/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3258072"
                        objectCount: "36"
                        recordCount: "36738"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition98:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=14/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3284494"
                        objectCount: "36"
                        recordCount: "36990"
                        averageRecordSize: "103"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition99:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=27/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3263345"
                        objectCount: "36"
                        recordCount: "36869"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition100:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=7/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3238230"
                        objectCount: "36"
                        recordCount: "36498"
                        averageRecordSize: "102"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition101:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2025/pickup_month=8/pickup_day=8/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3232958"
                        objectCount: "36"
                        recordCount: "36820"
                        averageRecordSize: "101"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition102:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "golden_kpis"
            DatabaseName: "nyc_taxi_db"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "total_rides"
                        Type: "bigint"
                      - 
                        Name: "total_fare"
                        Type: "double"
                      - 
                        Name: "total_tip"
                        Type: "double"
                      - 
                        Name: "total_revenue"
                        Type: "double"
                      - 
                        Name: "avg_fare"
                        Type: "double"
                      - 
                        Name: "avg_tip_pct"
                        Type: "double"
                      - 
                        Name: "num_high_tip_trips"
                        Type: "bigint"
                      - 
                        Name: "avg_trip_distance"
                        Type: "double"
                      - 
                        Name: "avg_trip_duration"
                        Type: "decimal(31,10)"
                      - 
                        Name: "sum_trip_distance"
                        Type: "double"
                      - 
                        Name: "num_long_trips"
                        Type: "bigint"
                      - 
                        Name: "num_short_trips"
                        Type: "bigint"
                      - 
                        Name: "num_rush_hour_rides"
                        Type: "bigint"
                      - 
                        Name: "revenue_per_mile"
                        Type: "double"
                      - 
                        Name: "avg_revenue_per_ride"
                        Type: "double"
                      - 
                        Name: "avg_speed_mph"
                        Type: "double"
                      - 
                        Name: "tip_per_mile"
                        Type: "double"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                      - 
                        Name: "data_domain"
                        Type: "string"
                      - 
                        Name: "aggregated_at"
                        Type: "bigint"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/kpis/pickup_year=2009/pickup_month=1/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "8809"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1133"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition103:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2954846"
                        objectCount: "1"
                        recordCount: "84046"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition104:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=21/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3092022"
                        objectCount: "2"
                        recordCount: "87872"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition105:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2624162"
                        objectCount: "2"
                        recordCount: "71527"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition106:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=6/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3250994"
                        objectCount: "2"
                        recordCount: "95391"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition107:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=16/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2836130"
                        objectCount: "2"
                        recordCount: "80278"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition108:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=18/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2639429"
                        objectCount: "2"
                        recordCount: "72794"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition109:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=23/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2966581"
                        objectCount: "2"
                        recordCount: "84161"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition110:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=17/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2635346"
                        objectCount: "1"
                        recordCount: "73884"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition111:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=29/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2954465"
                        objectCount: "2"
                        recordCount: "81754"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition112:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=14/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3226813"
                        objectCount: "2"
                        recordCount: "92850"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition113:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=15/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2977261"
                        objectCount: "2"
                        recordCount: "83451"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition114:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=5/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3093122"
                        objectCount: "2"
                        recordCount: "89328"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition115:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=2/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2834392"
                        objectCount: "2"
                        recordCount: "80585"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition116:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=9/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2648702"
                        objectCount: "1"
                        recordCount: "75311"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition117:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=12/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3068298"
                        objectCount: "2"
                        recordCount: "88960"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition118:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2009/pickup_month=1/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "12069"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1636"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition119:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=7/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3144778"
                        objectCount: "2"
                        recordCount: "90113"
                        averageRecordSize: "49"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition120:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=8/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2923308"
                        objectCount: "2"
                        recordCount: "82633"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition121:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=11/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2739040"
                        objectCount: "2"
                        recordCount: "76247"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition122:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=22/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2966870"
                        objectCount: "2"
                        recordCount: "82958"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition123:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=24/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2714363"
                        objectCount: "2"
                        recordCount: "74491"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition124:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=7/pickup_day=31/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "14140"
                        objectCount: "1"
                        recordCount: "13"
                        averageRecordSize: "306"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition125:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=3/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2609061"
                        objectCount: "2"
                        recordCount: "71809"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition126:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=13/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3355247"
                        objectCount: "2"
                        recordCount: "99105"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition127:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=27/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3072205"
                        objectCount: "2"
                        recordCount: "86863"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition128:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=10/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2499474"
                        objectCount: "2"
                        recordCount: "68120"
                        averageRecordSize: "52"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition129:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=28/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3097521"
                        objectCount: "2"
                        recordCount: "87008"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition130:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=26/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2969289"
                        objectCount: "2"
                        recordCount: "83807"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition131:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=4/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2767013"
                        objectCount: "2"
                        recordCount: "77805"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition132:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=9/pickup_day=1/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "12209"
                        objectCount: "1"
                        recordCount: "1"
                        averageRecordSize: "1653"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition133:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=20/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "3323153"
                        objectCount: "2"
                        recordCount: "97648"
                        averageRecordSize: "48"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition134:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=19/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2905672"
                        objectCount: "2"
                        recordCount: "82627"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition135:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=25/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2660865"
                        objectCount: "1"
                        recordCount: "74388"
                        averageRecordSize: "51"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition136:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "trip_level"
            DatabaseName: "s3-to-glue"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "vendorid"
                        Type: "int"
                      - 
                        Name: "tpep_pickup_datetime"
                        Type: "timestamp"
                      - 
                        Name: "tpep_dropoff_datetime"
                        Type: "timestamp"
                      - 
                        Name: "passenger_count"
                        Type: "double"
                      - 
                        Name: "trip_distance"
                        Type: "double"
                      - 
                        Name: "ratecodeid"
                        Type: "int"
                      - 
                        Name: "store_and_fwd_flag"
                        Type: "string"
                      - 
                        Name: "pulocationid"
                        Type: "int"
                      - 
                        Name: "dolocationid"
                        Type: "int"
                      - 
                        Name: "payment_type"
                        Type: "int"
                      - 
                        Name: "fare_amount"
                        Type: "double"
                      - 
                        Name: "extra"
                        Type: "double"
                      - 
                        Name: "mta_tax"
                        Type: "double"
                      - 
                        Name: "tip_amount"
                        Type: "double"
                      - 
                        Name: "tolls_amount"
                        Type: "double"
                      - 
                        Name: "improvement_surcharge"
                        Type: "double"
                      - 
                        Name: "total_amount"
                        Type: "double"
                      - 
                        Name: "congestion_surcharge"
                        Type: "double"
                      - 
                        Name: "airport_fee"
                        Type: "double"
                      - 
                        Name: "cbd_congestion_fee"
                        Type: "double"
                      - 
                        Name: "trip_duration_minutes"
                        Type: "decimal(27,6)"
                      - 
                        Name: "tip_pct"
                        Type: "double"
                      - 
                        Name: "pickup_hour"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_week"
                        Type: "int"
                      - 
                        Name: "pickup_day_of_month"
                        Type: "int"
                      - 
                        Name: "is_long_trip"
                        Type: "int"
                      - 
                        Name: "is_short_trip"
                        Type: "int"
                      - 
                        Name: "high_tip_flag"
                        Type: "int"
                      - 
                        Name: "vendor_id"
                        Type: "bigint"
                      - 
                        Name: "vendor_name"
                        Type: "string"
                      - 
                        Name: "rate_code_id"
                        Type: "bigint"
                      - 
                        Name: "rate_code_desc"
                        Type: "string"
                      - 
                        Name: "pu_locationid"
                        Type: "int"
                      - 
                        Name: "pu_borough"
                        Type: "string"
                      - 
                        Name: "pu_zone"
                        Type: "string"
                      - 
                        Name: "pu_service_zone"
                        Type: "string"
                      - 
                        Name: "do_locationid"
                        Type: "int"
                      - 
                        Name: "do_borough"
                        Type: "string"
                      - 
                        Name: "do_zone"
                        Type: "string"
                      - 
                        Name: "do_service_zone"
                        Type: "string"
                      - 
                        Name: "data_zone"
                        Type: "string"
                      - 
                        Name: "data_owner"
                        Type: "string"
                    Location: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/pickup_year=2025/pickup_month=8/pickup_day=30/"
                    InputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe"
                        Parameters: 
                            "serialization.format": "1"
                    Parameters: 
                        sizeKey: "2852028"
                        objectCount: "2"
                        recordCount: "79877"
                        averageRecordSize: "50"
                        compressionType: "none"
                        classification: "parquet"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GluePartition137:
        Type: "AWS::Glue::Partition"
        Properties:
            TableName: "dq_gluedataqualitylogs"
            DatabaseName: "data-quality-result-database"
            CatalogId: !Ref "AWS::AccountId"
            PartitionInput: 
                Parameters: {}
                StorageDescriptor: 
                    Columns: 
                      - 
                        Name: "ruleset_name"
                        Type: "string"
                      - 
                        Name: "databasename"
                        Type: "string"
                      - 
                        Name: "tablename"
                        Type: "string"
                      - 
                        Name: "runid"
                        Type: "string"
                      - 
                        Name: "resultid"
                        Type: "string"
                      - 
                        Name: "state"
                        Type: "string"
                      - 
                        Name: "score"
                        Type: "string"
                      - 
                        Name: "numrulessucceeded"
                        Type: "string"
                      - 
                        Name: "numrulesfailed"
                        Type: "string"
                      - 
                        Name: "numrulesskipped"
                        Type: "string"
                      - 
                        Name: "resultrun"
                        Type: "array<struct<Name:string,Result:string,Description:string,EvaluationMessage:string>>"
                    Location: !Sub "s3://${S3Bucket5}/gluedataqualitylogs/year=2026/month=01/day=04/"
                    InputFormat: "org.apache.hadoop.mapred.TextInputFormat"
                    OutputFormat: "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"
                    Compressed: false
                    NumberOfBuckets: -1
                    SerdeInfo: 
                        SerializationLibrary: "org.openx.data.jsonserde.JsonSerDe"
                        Parameters: 
                            paths: "databaseName,numRulesFailed,numRulesSkipped,numRulesSucceeded,resultId,resultrun,ruleset_name,runId,score,state,tableName"
                    Parameters: 
                        sizeKey: "1502"
                        objectCount: "2"
                        recordCount: "2"
                        averageRecordSize: "751"
                        compressionType: "none"
                        classification: "json"
                        typeOfData: "file"
                    StoredAsSubDirectories: false

    GlueCrawler:
        Type: "AWS::Glue::Crawler"
        Properties:
            Name: "crawler_for_curated"
            Role: !Ref IAMRole
            Targets: 
                S3Targets: 
                  - 
                    Path: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/"
            DatabaseName: "nyc_taxi_db"
            SchemaChangePolicy: 
                UpdateBehavior: "UPDATE_IN_DATABASE"
                DeleteBehavior: "DEPRECATE_IN_DATABASE"
            TablePrefix: "golden_"
            Configuration: "{\"Version\":1.0,\"CreatePartitionIndex\":true}"

    GlueCrawler2:
        Type: "AWS::Glue::Crawler"
        Properties:
            Name: "crawler_for_landing_raw"
            Role: !Ref IAMRole
            Targets: 
                S3Targets: 
                  - 
                    Path: !Sub "s3://${S3Bucket}/landing/yellow/"
            DatabaseName: "nyc_taxi_db"
            SchemaChangePolicy: 
                UpdateBehavior: "UPDATE_IN_DATABASE"
                DeleteBehavior: "DEPRECATE_IN_DATABASE"
            Configuration: "{\"Version\":1.0,\"CreatePartitionIndex\":true}"

    GlueCrawler3:
        Type: "AWS::Glue::Crawler"
        Properties:
            Name: "crawler_for_validated"
            Role: !Ref IAMRole
            Targets: 
                S3Targets: 
                  - 
                    Path: !Sub "s3://${S3Bucket}/validated/yellow/"
            DatabaseName: "nyc_taxi_db"
            SchemaChangePolicy: 
                UpdateBehavior: "UPDATE_IN_DATABASE"
                DeleteBehavior: "DEPRECATE_IN_DATABASE"
            Configuration: "{\"Version\":1.0,\"CreatePartitionIndex\":true}"

    GlueCrawler4:
        Type: "AWS::Glue::Crawler"
        Properties:
            Name: "data-quality-result-crawler"
            Role: "GlueDataQualityLaunchBlogDemoRole-0afffdf0f7eb"
            Targets: 
                S3Targets: 
                  - 
                    Path: !Sub "s3://${S3Bucket5}/gluedataqualitylogs/"
            DatabaseName: "data-quality-result-database"
            SchemaChangePolicy: 
                UpdateBehavior: "UPDATE_IN_DATABASE"
                DeleteBehavior: "DEPRECATE_IN_DATABASE"
            TablePrefix: "dq_"
            Configuration: "{\"Version\":1.0,\"CreatePartitionIndex\":true}"

    GlueCrawler5:
        Type: "AWS::Glue::Crawler"
        Properties:
            Name: "glue_to_rds"
            Role: !Ref IAMRole6
            Targets: 
                JdbcTargets: 
                  - 
                    ConnectionName: "Mysql connection"
                    Path: "nyc_taxi_mdm"
            DatabaseName: "data_migrate_rds"
            SchemaChangePolicy: 
                UpdateBehavior: "UPDATE_IN_DATABASE"
                DeleteBehavior: "DEPRECATE_IN_DATABASE"

    GlueCrawler6:
        Type: "AWS::Glue::Crawler"
        Properties:
            Name: "s3-to-glue"
            Role: !Ref IAMRole5
            Targets: 
                S3Targets: 
                  - 
                    Path: !Sub "s3://${S3Bucket}/curated/yellow_trips_enriched/trip_level/"
            DatabaseName: "s3-to-glue"
            SchemaChangePolicy: 
                UpdateBehavior: "UPDATE_IN_DATABASE"
                DeleteBehavior: "DEPRECATE_IN_DATABASE"
            Configuration: "{\"Version\":1.0,\"CreatePartitionIndex\":true}"

    GlueJob:
        Type: "AWS::Glue::Job"
        Properties:
            Name: "create_master_tables"
            Description: ""
            Role: !GetAtt IAMRole.Arn
            ExecutionProperty: 
                MaxConcurrentRuns: 1
            Command: 
                Name: "glueetl"
                ScriptLocation: !Sub "s3://${S3Bucket7}/scripts/create_master_tables.py"
                PythonVersion: "3"
            DefaultArguments: 
                --enable-metrics: "true"
                --enable-spark-ui: "true"
                --spark-event-logs-path: !Sub "s3://${S3Bucket7}/sparkHistoryLogs/"
                --enable-job-insights: "true"
                --enable-observability-metrics: "true"
                --enable-glue-datacatalog: "true"
                --job-bookmark-option: "job-bookmark-disable"
                --job-language: "python"
                --TempDir: !Sub "s3://${S3Bucket7}/temporary/"
            MaxRetries: 0
            AllocatedCapacity: 10
            Timeout: 480
            GlueVersion: "5.0"
            MaxCapacity: 10
            NumberOfWorkers: 10
            WorkerType: "G.1X"

    GlueJob2:
        Type: "AWS::Glue::Job"
        Properties:
            Name: "glue-to-rds"
            Description: ""
            Role: !GetAtt IAMRole6.Arn
            ExecutionProperty: 
                MaxConcurrentRuns: 1
            Command: 
                Name: "glueetl"
                ScriptLocation: !Sub "s3://${S3Bucket7}/scripts/glue-to-rds.py"
                PythonVersion: "3"
            DefaultArguments: 
                --enable-metrics: "true"
                --enable-spark-ui: "true"
                --spark-event-logs-path: !Sub "s3://${S3Bucket7}/sparkHistoryLogs/"
                --enable-job-insights: "true"
                --enable-observability-metrics: "true"
                --enable-glue-datacatalog: "true"
                --job-bookmark-option: "job-bookmark-disable"
                --job-language: "python"
                --TempDir: !Sub "s3://${S3Bucket7}/temporary/"
            Connections: 
                Connections: 
                  - "Mysql connection"
            MaxRetries: 0
            AllocatedCapacity: 10
            Timeout: 480
            GlueVersion: "5.0"
            MaxCapacity: 10
            NumberOfWorkers: 10
            WorkerType: "G.1X"

    GlueJob3:
        Type: "AWS::Glue::Job"
        Properties:
            Name: "load_mdm_taxi_zone"
            Description: ""
            Role: !GetAtt IAMRole6.Arn
            ExecutionProperty: 
                MaxConcurrentRuns: 1
            Command: 
                Name: "glueetl"
                ScriptLocation: !Sub "s3://${S3Bucket7}/scripts/load_mdm_taxi_zone.py"
                PythonVersion: "3"
            DefaultArguments: 
                --enable-metrics: "true"
                --enable-spark-ui: "true"
                --spark-event-logs-path: !Sub "s3://${S3Bucket7}/sparkHistoryLogs/"
                --enable-job-insights: "true"
                --enable-observability-metrics: "true"
                --enable-glue-datacatalog: "true"
                --job-bookmark-option: "job-bookmark-disable"
                --job-language: "python"
                --TempDir: !Sub "s3://${S3Bucket7}/temporary/"
            MaxRetries: 0
            AllocatedCapacity: 10
            Timeout: 480
            GlueVersion: "5.0"
            MaxCapacity: 10
            NumberOfWorkers: 10
            WorkerType: "G.1X"

    GlueJob4:
        Type: "AWS::Glue::Job"
        Properties:
            Name: "yellow_raw_to_validated"
            Description: ""
            Role: !GetAtt IAMRole.Arn
            ExecutionProperty: 
                MaxConcurrentRuns: 3
            Command: 
                Name: "glueetl"
                ScriptLocation: !Sub "s3://${S3Bucket7}/scripts/yellow_raw_to_validated.py"
                PythonVersion: "3"
            DefaultArguments: 
                --enable-metrics: "true"
                --enable-spark-ui: "true"
                --spark-event-logs-path: !Sub "s3://${S3Bucket7}/sparkHistoryLogs/"
                --enable-job-insights: "true"
                --enable-observability-metrics: "true"
                --enable-glue-datacatalog: "true"
                --job-bookmark-option: "job-bookmark-disable"
                --job-language: "python"
                --TempDir: !Sub "s3://${S3Bucket7}/temporary/"
            MaxRetries: 0
            AllocatedCapacity: 10
            Timeout: 480
            GlueVersion: "5.0"
            MaxCapacity: 10
            NumberOfWorkers: 10
            WorkerType: "G.1X"

    GlueJob5:
        Type: "AWS::Glue::Job"
        Properties:
            Name: "yellow_validated_to_curated"
            Description: ""
            Role: !GetAtt IAMRole.Arn
            ExecutionProperty: 
                MaxConcurrentRuns: 1
            Command: 
                Name: "glueetl"
                ScriptLocation: !Sub "s3://${S3Bucket7}/scripts/yellow_validated_to_curated.py"
                PythonVersion: "3"
            DefaultArguments: 
                --enable-metrics: "true"
                --enable-spark-ui: "true"
                --spark-event-logs-path: !Sub "s3://${S3Bucket7}/sparkHistoryLogs/"
                --enable-job-insights: "true"
                --enable-observability-metrics: "true"
                --enable-glue-datacatalog: "true"
                --job-bookmark-option: "job-bookmark-disable"
                --job-language: "python"
                --TempDir: !Sub "s3://${S3Bucket7}/temporary/"
            MaxRetries: 0
            AllocatedCapacity: 10
            Timeout: 480
            GlueVersion: "5.0"
            MaxCapacity: 10
            NumberOfWorkers: 10
            WorkerType: "G.1X"

    GlueJob6:
        Type: "AWS::Glue::Job"
        Properties:
            Name: "zone-loadto-rds"
            Description: ""
            Role: !GetAtt IAMRole6.Arn
            ExecutionProperty: 
                MaxConcurrentRuns: 1
            Command: 
                Name: "glueetl"
                ScriptLocation: !Sub "s3://${S3Bucket7}/scripts/zone-loadto-rds.py"
                PythonVersion: "3"
            DefaultArguments: 
                --enable-metrics: "true"
                --enable-spark-ui: "true"
                --spark-event-logs-path: !Sub "s3://${S3Bucket7}/sparkHistoryLogs/"
                --enable-job-insights: "true"
                --enable-observability-metrics: "true"
                --enable-glue-datacatalog: "true"
                --job-bookmark-option: "job-bookmark-disable"
                --job-language: "python"
                --TempDir: !Sub "s3://${S3Bucket7}/temporary/"
            Connections: 
                Connections: 
                  - "Mysql connection"
            MaxRetries: 0
            AllocatedCapacity: 10
            Timeout: 480
            GlueVersion: "5.0"
            MaxCapacity: 10
            NumberOfWorkers: 10
            WorkerType: "G.1X"

    GlueConnection:
        Type: "AWS::Glue::Connection"
        Properties:
            ConnectionInput: 
                Description: ""
                ConnectionType: "JDBC"
                PhysicalConnectionRequirements: 
                    SubnetId: "subnet-035019ddcaf604cc1"
                    SecurityGroupIdList: 
                      - "sg-0fbdd85b08ec89173"
                    AvailabilityZone: !Sub "${AWS::Region}d"
                ConnectionProperties: 
                    JDBC_ENFORCE_SSL: "false"
                    JDBC_CONNECTION_URL: !Sub "jdbc:mysql://${RDSDBInstance}.cg9gsgsi831x.${AWS::Region}.rds.amazonaws.com:${RDSDBInstance.Endpoint.Port}/nyc_taxi_mdm?useSSL=false&serverTimezone=UTC"
                    USERNAME: "admin"
                    PASSWORD: "biyaguda9@"
                    KAFKA_SSL_ENABLED: "false"
                Name: "Jdbc connection"
            CatalogId: !Ref "AWS::AccountId"

    GlueConnection2:
        Type: "AWS::Glue::Connection"
        Properties:
            ConnectionInput: 
                Description: ""
                ConnectionType: "MYSQL"
                PhysicalConnectionRequirements: 
                    SubnetId: "subnet-035019ddcaf604cc1"
                    SecurityGroupIdList: 
                      - "sg-0fbdd85b08ec89173"
                    AvailabilityZone: !Sub "${AWS::Region}d"
                ConnectionProperties: 
                    HOST: !GetAtt RDSDBInstance.Endpoint.Address
                    ROLE_ARN: !GetAtt IAMRole6.Arn
                    DATABASE: "nyc_taxi_mdm"
                    PORT: !Sub "${RDSDBInstance.Endpoint.Port}"
                    KAFKA_SSL_ENABLED: "false"
                Name: "Mysql connection"
            CatalogId: !Ref "AWS::AccountId"

    RedshiftServerlessNamespace:
        Type: "AWS::RedshiftServerless::Namespace"
        Properties:
            AdminUsername: "admin"
            AdminUserPassword: "REPLACEME"
            DbName: "dev"
            DefaultIamRoleArn: !GetAtt IAMRole2.Arn
            IamRoles: 
              - !Sub "IamRole(applyStatus=in-sync, iamRoleArn=arn:aws:iam::${AWS::AccountId}:role/service-role/${IAMRole2})"
            KmsKeyId: !GetAtt KMSKey.Arn
            NamespaceName: "nyc-taxi-dw"

    RedshiftServerlessWorkgroup:
        Type: "AWS::RedshiftServerless::Workgroup"
        Properties:
            BaseCapacity: 128
            ConfigParameters: 
              - 
                ParameterKey: "auto_mv"
                ParameterValue: "true"
              - 
                ParameterKey: "datestyle"
                ParameterValue: "ISO, MDY"
              - 
                ParameterKey: "enable_case_sensitive_identifier"
                ParameterValue: "false"
              - 
                ParameterKey: "enable_user_activity_logging"
                ParameterValue: "true"
              - 
                ParameterKey: "query_group"
                ParameterValue: "default"
              - 
                ParameterKey: "require_ssl"
                ParameterValue: "true"
              - 
                ParameterKey: "search_path"
                ParameterValue: "$user, public"
              - 
                ParameterKey: "use_fips_ssl"
                ParameterValue: "false"
              - 
                ParameterKey: "max_query_execution_time"
                ParameterValue: "14400"
            EnhancedVpcRouting: true
            NamespaceName: !Ref RedshiftServerlessNamespace
            PubliclyAccessible: false
            SecurityGroupIds: 
              - "sg-0fbdd85b08ec89173"
              - "sg-001731948fd63b4d1"
            SubnetIds: 
              - "subnet-0cc3bdd4bded8cab8"
              - "subnet-015a32a4e12b26561"
              - "subnet-035019ddcaf604cc1"
              - "subnet-06559bb761049eb5a"
              - "subnet-0d5b87d5ae0829b87"
              - "subnet-0826e31fd816e808d"
            WorkgroupName: "default-workgroup"

    LakeFormationPermissions:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: !Sub "arn:aws:iam::${AWS::AccountId}:root"
            Permissions: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            PermissionsWithGrantOption: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "default"

    LakeFormationPermissions2:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS"
            Permissions: 
              - "ALL"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "default"

    LakeFormationPermissions3:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: !Sub "arn:aws:iam::${AWS::AccountId}:root"
            Permissions: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            PermissionsWithGrantOption: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "data-quality-result-database"

    LakeFormationPermissions4:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS"
            Permissions: 
              - "ALL"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "data-quality-result-database"

    LakeFormationPermissions5:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: !Sub "arn:aws:iam::${AWS::AccountId}:root"
            Permissions: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            PermissionsWithGrantOption: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "data_migrate_rds"

    LakeFormationPermissions6:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS"
            Permissions: 
              - "ALL"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "data_migrate_rds"

    LakeFormationPermissions7:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: !Sub "arn:aws:iam::${AWS::AccountId}:root"
            Permissions: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            PermissionsWithGrantOption: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "s3-to-glue"

    LakeFormationPermissions8:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS"
            Permissions: 
              - "ALL"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "s3-to-glue"

    LakeFormationPermissions9:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: !Sub "arn:aws:iam::${AWS::AccountId}:root"
            Permissions: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            PermissionsWithGrantOption: 
              - "ALL"
              - "ALTER"
              - "CREATE_TABLE"
              - "DESCRIBE"
              - "DROP"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "nyc_taxi_db"

    LakeFormationPermissions10:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS"
            Permissions: 
              - "ALL"
            Resource: 
                DatabaseResource: 
                    CatalogId: !Ref AWS::AccountId
                    Name: "nyc_taxi_db"

    LakeFormationPermissions11:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: !Sub "arn:aws:iam::${AWS::AccountId}:root"
            Permissions: 
              - "ALL"
              - "ALTER"
              - "DELETE"
              - "DESCRIBE"
              - "DROP"
              - "INSERT"
            PermissionsWithGrantOption: 
              - "ALL"
              - "ALTER"
              - "DELETE"
              - "DESCRIBE"
              - "DROP"
              - "INSERT"
            Resource: 
                TableResource: 
                    CatalogId: !Ref AWS::AccountId
                    DatabaseName: "data-quality-result-database"
                    Name: "data_quality_result_view"

    LakeFormationPermissions12:
        Type: "AWS::LakeFormation::Permissions"
        Properties:
            DataLakePrincipal: 
                DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS"
            Permissions: 
              - "ALL"
            Resource: 
                TableResource: 
                    CatalogId: !Ref AWS::AccountId
                    DatabaseName: "data-quality-result-database"
                    Name: "data_quality_result_view"

    SecretsManagerSecret:
        Type: "AWS::SecretsManager::Secret"
        Properties:
            Name: !Sub "glue!${AWS::AccountId}-Mysqlconnection-1767934620176"
            Description: "glue owned service linked secret created for Glue ConnectionMysql connection. Deleting the secret will fail the associated connection."
            SecretString: "{\"PASSWORD\":\"Srinivas1998\",\"USERNAME\":\"mdm_admin\"}"

    SecretsManagerSecret2:
        Type: "AWS::SecretsManager::Secret"
        Properties:
            Name: "sqlworkbench!7822772f-87a6-4347-bba2-990a6e2ae2fa"
            Description: "Secret created for an AWS SQL Workbench connection"
            Tags: 
              - 
                Key: "sqlworkbench-resource-owner"
                Value: !Ref AWS::AccountId
            SecretString: "{\"engine\":\"redshift\",\"username\":\"admin\",\"password\":\"Srinivas1998\",\"dbName\":\"dev\",\"dbClusterIdentifier\":\"Serverless\",\"port\":5439}"

    SecretsManagerSecret3:
        Type: "AWS::SecretsManager::Secret"
        Properties:
            Name: !Sub "${RedshiftServerlessNamespace}/redshift-credentials"
            Description: "Production Redshift credentials for NYC Taxi DW"
            KmsKeyId: !GetAtt KMSKey.Arn
            Tags: 
              - 
                Key: "Environment"
                Value: "Production"
              - 
                Key: "Application"
                Value: "NYC-Taxi-DW"
            SecretString: !Sub "{\"username\":\"mdm_admin\",\"password\":\"Srinivas1998\",\"dbname\":\"dev\",\"host\":\"${RedshiftServerlessWorkgroup}.${AWS::AccountId}.${AWS::Region}.redshift-serverless.amazonaws.com\",\"port\":5439,\"namespaceName\":\"${RedshiftServerlessNamespace}\",\"engine\":\"redshift\"}"

    SecretsManagerResourcePolicy:
        Type: "AWS::SecretsManager::ResourcePolicy"
        Properties:
            SecretId: !Ref SecretsManagerSecret
            ResourcePolicy: !Sub |
                {
                  "Version" : "2012-10-17",
                  "Statement" : [ {
                    "Effect" : "Allow",
                    "Principal" : {
                      "AWS" : "arn:aws:iam::${AWS::AccountId}:role/${IAMRole6}"
                    },
                    "Action" : [ "secretsmanager:GetSecretValue", "secretsmanager:PutSecretValue", "secretsmanager:DescribeSecret", "secretsmanager:UpdateSecret", "secretsmanager:PutResourcePolicy", "secretsmanager:DeleteSecret" ],
                    "Resource" : "*"
                  } ]
                }

    SecretsManagerRotationSchedule:
        Type: "AWS::SecretsManager::RotationSchedule"
        Properties:
            SecretId: !Sub "arn:aws:secretsmanager:${AWS::Region}:${AWS::AccountId}:secret:${RedshiftServerlessNamespace}/redshift-credentials-9n79wZ"
            RotationLambdaARN: !Sub "arn:aws:lambda:${AWS::Region}:${AWS::AccountId}:function:SecretsManagerrotation_lambda"
            RotationRules: 
                AutomaticallyAfterDays: 30
                ScheduleExpression: "rate(30 days)"

